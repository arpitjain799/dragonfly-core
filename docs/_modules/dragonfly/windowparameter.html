<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>dragonfly.windowparameter &#8212; dragonfly-core  documentation</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          dragonfly-core</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../cli/index.html">CLI Docs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cli/index.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cli/index.html#commands">Commands</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../cli/translate.html">translate</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../cli/translate.html#dragonfly-translate">dragonfly translate</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../cli/translate.html#dragonfly-translate-merge-models-to-honeybee">merge-models-to-honeybee</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../cli/translate.html#dragonfly-translate-model-from-geojson">model-from-geojson</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../cli/translate.html#dragonfly-translate-model-to-honeybee">model-to-honeybee</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../cli/translate.html#dragonfly-translate-model-to-honeybee-file">model-to-honeybee-file</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../cli/edit.html">edit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../cli/edit.html#dragonfly-edit">dragonfly edit</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../cli/edit.html#dragonfly-edit-align">align</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../cli/edit.html#dragonfly-edit-convert-units">convert-units</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../cli/edit.html#dragonfly-edit-remove-short-segments">remove-short-segments</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../cli/edit.html#dragonfly-edit-reset-room-boundaries">reset-room-boundaries</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../cli/edit.html#dragonfly-edit-solve-adjacency">solve-adjacency</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../cli/edit.html#dragonfly-edit-windows-by-ratio">windows-by-ratio</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../cli/create.html">create</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../cli/create.html#dragonfly-create">dragonfly create</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../cli/create.html#dragonfly-create-merge-models">merge-models</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../cli/validate.html">validate</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../cli/validate.html#dragonfly-validate">dragonfly validate</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../cli/validate.html#dragonfly-validate-model">model</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">dragonfly</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../dragonfly.html">dragonfly package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../dragonfly.html#subpackages">Subpackages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../dragonfly.cli.html">dragonfly.cli package</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../dragonfly.cli.html#submodules">Submodules</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../dragonfly.cli.create.html">dragonfly.cli.create module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../dragonfly.cli.edit.html">dragonfly.cli.edit module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../dragonfly.cli.translate.html">dragonfly.cli.translate module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../dragonfly.cli.validate.html">dragonfly.cli.validate module</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../dragonfly.cli.html#module-dragonfly.cli">Module contents</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../dragonfly.writer.html">dragonfly.writer package</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../dragonfly.writer.html#submodules">Submodules</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../dragonfly.writer.building.html">dragonfly.writer.building module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../dragonfly.writer.context.html">dragonfly.writer.context module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../dragonfly.writer.model.html">dragonfly.writer.model module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../dragonfly.writer.room2d.html">dragonfly.writer.room2d module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../dragonfly.writer.story.html">dragonfly.writer.story module</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../dragonfly.writer.html#module-dragonfly.writer">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../dragonfly.html#submodules">Submodules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../dragonfly.building.html">dragonfly.building module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dragonfly.colorobj.html">dragonfly.colorobj module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dragonfly.config.html">dragonfly.config module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dragonfly.context.html">dragonfly.context module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dragonfly.dictutil.html">dragonfly.dictutil module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dragonfly.extensionutil.html">dragonfly.extensionutil module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dragonfly.model.html">dragonfly.model module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dragonfly.projection.html">dragonfly.projection module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dragonfly.properties.html">dragonfly.properties module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dragonfly.roof.html">dragonfly.roof module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dragonfly.room2d.html">dragonfly.room2d module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dragonfly.shadingparameter.html">dragonfly.shadingparameter module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dragonfly.skylightparameter.html">dragonfly.skylightparameter module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dragonfly.story.html">dragonfly.story module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dragonfly.subdivide.html">dragonfly.subdivide module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../dragonfly.windowparameter.html">dragonfly.windowparameter module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../dragonfly.html#module-dragonfly">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../cli/index.html">CLI Docs</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">dragonfly</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-4">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../cli/index.html">CLI Docs</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">dragonfly</a></li>
</ul>

        </div>
      </div>
    <div class="body col-md-8 content" role="main">
      
  <h1>Source code for dragonfly.windowparameter</h1><div class="highlight"><pre>
<span></span><span class="c1"># coding: utf-8</span>
<span class="sd">&quot;&quot;&quot;Window Parameters with instructions for generating windows.&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="kn">from</span> <span class="nn">honeybee.typing</span> <span class="kn">import</span> <span class="n">float_in_range</span><span class="p">,</span> <span class="n">float_positive</span>
<span class="kn">from</span> <span class="nn">honeybee.boundarycondition</span> <span class="kn">import</span> <span class="n">Surface</span>
<span class="kn">from</span> <span class="nn">honeybee.aperture</span> <span class="kn">import</span> <span class="n">Aperture</span>
<span class="kn">from</span> <span class="nn">honeybee.door</span> <span class="kn">import</span> <span class="n">Door</span>

<span class="kn">from</span> <span class="nn">ladybug_geometry.geometry2d.pointvector</span> <span class="kn">import</span> <span class="n">Point2D</span><span class="p">,</span> <span class="n">Vector2D</span>
<span class="kn">from</span> <span class="nn">ladybug_geometry.geometry2d.polygon</span> <span class="kn">import</span> <span class="n">Polygon2D</span>
<span class="kn">from</span> <span class="nn">ladybug_geometry.geometry3d.pointvector</span> <span class="kn">import</span> <span class="n">Vector3D</span><span class="p">,</span> <span class="n">Point3D</span>
<span class="kn">from</span> <span class="nn">ladybug_geometry.geometry3d.line</span> <span class="kn">import</span> <span class="n">LineSegment3D</span>
<span class="kn">from</span> <span class="nn">ladybug_geometry.geometry3d.plane</span> <span class="kn">import</span> <span class="n">Plane</span>
<span class="kn">from</span> <span class="nn">ladybug_geometry.geometry3d.face</span> <span class="kn">import</span> <span class="n">Face3D</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="k">if</span> <span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">version_info</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">)):</span>  <span class="c1"># python 2</span>
    <span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">izip</span> <span class="k">as</span> <span class="nb">zip</span>  <span class="c1"># python 2</span>


<span class="k">class</span> <span class="nc">_WindowParameterBase</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base object for all window parameters.</span>

<span class="sd">    This object records all of the methods that must be overwritten on a window</span>
<span class="sd">    parameter object for it to be successfully be applied in dragonfly workflows.</span>

<span class="sd">    Properties:</span>
<span class="sd">        * user_data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_user_data&#39;</span><span class="p">,)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_user_data</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">user_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get or set an optional dictionary for additional meta data for this object.</span>

<span class="sd">        This will be None until it has been set. All keys and values of this</span>
<span class="sd">        dictionary should be of a standard Python type to ensure correct</span>
<span class="sd">        serialization of the object to/from JSON (eg. str, float, int, list dict)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_user_data</span>

    <span class="nd">@user_data</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">user_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">),</span> <span class="s1">&#39;Expected dictionary for honeybee &#39;</span> \
                <span class="s1">&#39;object user_data. Got </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_user_data</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">area_from_segment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">segment</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the window area generated by these parameters from a LineSegment3D.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">add_window_to_face</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">face</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add Apertures to a Honeybee Face using these Window Parameters.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a scaled version of these WindowParameters.</span>

<span class="sd">        This method is called within the scale methods of the Room2D.</span>

<span class="sd">        Args:</span>
<span class="sd">            factor: A number representing how much the object should be scaled.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">merge_to_rectangular</span><span class="p">(</span><span class="n">window_parameters</span><span class="p">,</span> <span class="n">segments</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Merge any window parameters together into rectangular windows.</span>

<span class="sd">        Args:</span>
<span class="sd">            window_parameters: A list of WindowParameters to be merged.</span>
<span class="sd">            segments: The segments to which the window parameters are assigned.</span>
<span class="sd">                These should be in order as they appear on the parent Room2D.</span>
<span class="sd">            floor_to_ceiling_height: The floor-to-ceiling height of the Room2D</span>
<span class="sd">                to which the segment belongs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">base_x</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">origins</span><span class="p">,</span> <span class="n">widths</span><span class="p">,</span> <span class="n">heights</span><span class="p">,</span> <span class="n">doors</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">wp</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">window_parameters</span><span class="p">,</span> <span class="n">segments</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">wp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">rwp</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">to_rectangular_windows</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">)</span>
                <span class="n">zip_obj</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">rwp</span><span class="o">.</span><span class="n">origins</span><span class="p">,</span> <span class="n">rwp</span><span class="o">.</span><span class="n">widths</span><span class="p">,</span> <span class="n">rwp</span><span class="o">.</span><span class="n">heights</span><span class="p">,</span> <span class="n">rwp</span><span class="o">.</span><span class="n">are_doors</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">o</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">zip_obj</span><span class="p">:</span>
                    <span class="n">origins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Point2D</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">base_x</span><span class="p">,</span> <span class="n">o</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
                    <span class="n">widths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
                    <span class="n">heights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
                    <span class="n">doors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
            <span class="n">base_x</span> <span class="o">+=</span> <span class="n">s</span><span class="o">.</span><span class="n">length</span>
        <span class="k">return</span> <span class="n">RectangularWindows</span><span class="p">(</span><span class="n">origins</span><span class="p">,</span> <span class="n">widths</span><span class="p">,</span> <span class="n">heights</span><span class="p">,</span> <span class="n">doors</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create WindowParameterBase from a dictionary.</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            {</span>
<span class="sd">            &quot;type&quot;: &quot;WindowParameterBase&quot;</span>
<span class="sd">            }</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;WindowParameterBase&#39;</span><span class="p">,</span> \
            <span class="s1">&#39;Expected WindowParameterBase dictionary. Got </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">])</span>
        <span class="n">new_w_par</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>
        <span class="k">if</span> <span class="s1">&#39;user_data&#39;</span> <span class="ow">in</span> <span class="n">data</span> <span class="ow">and</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;user_data&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">new_w_par</span><span class="o">.</span><span class="n">user_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;user_data&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">new_w_par</span>

    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get WindowParameterBase as a dictionary.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;WindowParameterBase&#39;</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">duplicate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a copy of this object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__copy__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">ToString</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_add_user_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_win_par</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add copies of this object&#39;s user_data to new WindowParameters.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">w_par</span> <span class="ow">in</span> <span class="n">new_win_par</span><span class="p">:</span>
                <span class="n">w_par</span><span class="o">.</span><span class="n">user_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_apply_user_data_to_honeybee</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sub_faces</span><span class="p">,</span> <span class="n">clean_data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply the WindowParameter user_data to generated honeybee objects.</span>

<span class="sd">        Args:</span>
<span class="sd">            sub_faces: An array of Honeybee Apertures or Doors to which user_data</span>
<span class="sd">                will be applied from this WindowParameter.</span>
<span class="sd">            clean_data: An optional dictionary of user_data to be used in place</span>
<span class="sd">                of the currently assigned user_data. This is useful when not all</span>
<span class="sd">                WindowParameters are able to be applied to the generated Honeybee</span>
<span class="sd">                objects. When None, the self.user_data will be used. (Default: None).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">app_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="k">if</span> <span class="n">clean_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">clean_data</span>
        <span class="k">if</span> <span class="n">app_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sub_f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sub_faces</span><span class="p">):</span>
                <span class="n">u_dict</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">app_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">u_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>  <span class="c1"># use longest list logic</span>
                            <span class="n">u_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">u_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
                <span class="n">sub_f</span><span class="o">.</span><span class="n">user_data</span> <span class="o">=</span> <span class="n">u_dict</span>

    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_WindowParameterBase</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;WindowParameterBase&#39;</span>


<div class="viewcode-block" id="SingleWindow"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.SingleWindow">[docs]</a><span class="k">class</span> <span class="nc">SingleWindow</span><span class="p">(</span><span class="n">_WindowParameterBase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Instructions for a single window in the face center defined by a width x height.</span>

<span class="sd">    Note that, if these parameters are applied to a base face that is too short</span>
<span class="sd">    or too narrow for the input width and/or height, the generated window will</span>
<span class="sd">    automatically be shortened when it is applied to the face. In this way,</span>
<span class="sd">    setting the width to be `float(&#39;inf&#39;)` will create parameters that always</span>
<span class="sd">    generate a ribbon window of the input height.</span>

<span class="sd">    Args:</span>
<span class="sd">        width: A number for the window width.</span>
<span class="sd">        height: A number for the window height.</span>
<span class="sd">        sill_height: A number for the window sill height. Default: 1.</span>

<span class="sd">    Properties:</span>
<span class="sd">        * width</span>
<span class="sd">        * height</span>
<span class="sd">        * sill_height</span>
<span class="sd">        * user_data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_width&#39;</span><span class="p">,</span> <span class="s1">&#39;_height&#39;</span><span class="p">,</span> <span class="s1">&#39;_sill_height&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">sill_height</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize SingleWindow.&quot;&quot;&quot;</span>
        <span class="n">_WindowParameterBase</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="c1"># add the user_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_width</span> <span class="o">=</span> <span class="n">float_positive</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="s1">&#39;window width&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_height</span> <span class="o">=</span> <span class="n">float_positive</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="s1">&#39;window height&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sill_height</span> <span class="o">=</span> <span class="n">float_positive</span><span class="p">(</span><span class="n">sill_height</span><span class="p">,</span> <span class="s1">&#39;window sill height&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">width</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a number for the window width.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_width</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">height</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a number for the window height.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_height</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sill_height</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a number for the sill height.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sill_height</span>

<div class="viewcode-block" id="SingleWindow.area_from_segment"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.SingleWindow.area_from_segment">[docs]</a>    <span class="k">def</span> <span class="nf">area_from_segment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">segment</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the window area generated by these parameters from a LineSegment3D.</span>

<span class="sd">        Args:</span>
<span class="sd">            segment: A LineSegment3D to which these parameters are applied.</span>
<span class="sd">            floor_to_ceiling_height: The floor-to-ceiling height of the Room2D</span>
<span class="sd">                to which the segment belongs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">max_width</span> <span class="o">=</span> <span class="n">segment</span><span class="o">.</span><span class="n">length</span> <span class="o">*</span> <span class="mf">0.99</span>
        <span class="n">max_height</span> <span class="o">=</span> <span class="p">(</span><span class="n">floor_to_ceiling_height</span> <span class="o">*</span> <span class="mf">0.99</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">sill_height</span>
        <span class="n">final_width</span> <span class="o">=</span> <span class="n">max_width</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">&gt;</span> <span class="n">max_width</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span>
        <span class="n">final_height</span> <span class="o">=</span> <span class="n">max_height</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">&gt;</span> <span class="n">max_height</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span>
        <span class="k">if</span> <span class="n">final_height</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">final_width</span> <span class="o">*</span> <span class="n">final_height</span></div>

<div class="viewcode-block" id="SingleWindow.to_rectangular_windows"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.SingleWindow.to_rectangular_windows">[docs]</a>    <span class="k">def</span> <span class="nf">to_rectangular_windows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">segment</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a version of these WindowParameters as RectangularWindows.</span>

<span class="sd">        Args:</span>
<span class="sd">            segment: A LineSegment3D to which these parameters are applied.</span>
<span class="sd">            floor_to_ceiling_height: The floor-to-ceiling height of the Room2D</span>
<span class="sd">                to which the segments belong.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">max_width</span> <span class="o">=</span> <span class="n">segment</span><span class="o">.</span><span class="n">length</span> <span class="o">*</span> <span class="mf">0.99</span>
        <span class="n">max_height</span> <span class="o">=</span> <span class="p">(</span><span class="n">floor_to_ceiling_height</span> <span class="o">*</span> <span class="mf">0.99</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">sill_height</span>
        <span class="n">final_width</span> <span class="o">=</span> <span class="n">max_width</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">&gt;</span> <span class="n">max_width</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span>
        <span class="n">final_height</span> <span class="o">=</span> <span class="n">max_height</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">&gt;</span> <span class="n">max_height</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span>
        <span class="k">if</span> <span class="n">final_height</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">origin</span> <span class="o">=</span> <span class="n">Point2D</span><span class="p">((</span><span class="n">segment</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span> <span class="n">final_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sill_height</span><span class="p">)</span>
            <span class="n">new_w</span> <span class="o">=</span> <span class="n">RectangularWindows</span><span class="p">([</span><span class="n">origin</span><span class="p">],</span> <span class="p">[</span><span class="n">final_width</span><span class="p">],</span> <span class="p">[</span><span class="n">final_height</span><span class="p">])</span>
            <span class="n">new_w</span><span class="o">.</span><span class="n">_user_data</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">new_w</span></div>

<div class="viewcode-block" id="SingleWindow.add_window_to_face"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.SingleWindow.add_window_to_face">[docs]</a>    <span class="k">def</span> <span class="nf">add_window_to_face</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">face</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add Apertures to a Honeybee Face using these Window Parameters.</span>

<span class="sd">        Args:</span>
<span class="sd">            face: A honeybee-core Face object.</span>
<span class="sd">            tolerance: Optional tolerance value. Default: 0.01, suitable for</span>
<span class="sd">                objects in meters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_width</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_height</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">width_seg</span> <span class="o">=</span> <span class="n">LineSegment3D</span><span class="o">.</span><span class="n">from_end_points</span><span class="p">(</span><span class="n">face</span><span class="o">.</span><span class="n">geometry</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">face</span><span class="o">.</span><span class="n">geometry</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">height_seg</span> <span class="o">=</span> <span class="n">LineSegment3D</span><span class="o">.</span><span class="n">from_end_points</span><span class="p">(</span><span class="n">face</span><span class="o">.</span><span class="n">geometry</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">face</span><span class="o">.</span><span class="n">geometry</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">max_width</span> <span class="o">=</span> <span class="n">width_seg</span><span class="o">.</span><span class="n">length</span> <span class="o">*</span> <span class="mf">0.99</span>
        <span class="n">max_height</span> <span class="o">=</span> <span class="p">(</span><span class="n">height_seg</span><span class="o">.</span><span class="n">length</span> <span class="o">*</span> <span class="mf">0.99</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">sill_height</span>
        <span class="n">final_width</span> <span class="o">=</span> <span class="n">max_width</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">&gt;</span> <span class="n">max_width</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span>
        <span class="n">final_height</span> <span class="o">=</span> <span class="n">max_height</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">&gt;</span> <span class="n">max_height</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span>
        <span class="k">if</span> <span class="n">final_height</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">face</span><span class="o">.</span><span class="n">aperture_by_width_height</span><span class="p">(</span><span class="n">final_width</span><span class="p">,</span> <span class="n">final_height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sill_height</span><span class="p">)</span>
            <span class="c1"># if the Aperture is interior, set adjacent boundary condition</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">face</span><span class="o">.</span><span class="n">_boundary_condition</span><span class="p">,</span> <span class="n">Surface</span><span class="p">):</span>
                <span class="n">ids</span> <span class="o">=</span> <span class="n">face</span><span class="o">.</span><span class="n">_boundary_condition</span><span class="o">.</span><span class="n">boundary_condition_objects</span>
                <span class="n">adj_ap_id</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_Glz1&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ids</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">final_ids</span> <span class="o">=</span> <span class="p">(</span><span class="n">adj_ap_id</span><span class="p">,)</span> <span class="o">+</span> <span class="n">ids</span>
                <span class="n">face</span><span class="o">.</span><span class="n">apertures</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">boundary_condition</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">final_ids</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_apply_user_data_to_honeybee</span><span class="p">(</span><span class="n">face</span><span class="o">.</span><span class="n">apertures</span><span class="p">)</span></div>

<div class="viewcode-block" id="SingleWindow.scale"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.SingleWindow.scale">[docs]</a>    <span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a scaled version of these WindowParameters.</span>

<span class="sd">        This method is called within the scale methods of the Room2D.</span>

<span class="sd">        Args:</span>
<span class="sd">            factor: A number representing how much the object should be scaled.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_w</span> <span class="o">=</span> <span class="n">SingleWindow</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="n">factor</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">*</span> <span class="n">factor</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sill_height</span> <span class="o">*</span> <span class="n">factor</span><span class="p">)</span>
        <span class="n">new_w</span><span class="o">.</span><span class="n">_user_data</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">new_w</span></div>

<div class="viewcode-block" id="SingleWindow.split"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.SingleWindow.split">[docs]</a>    <span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">segments</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Split SingleWindow parameters across a list of ordered segments.</span>

<span class="sd">        Args:</span>
<span class="sd">            segments: The segments to which the window parameters are being</span>
<span class="sd">                split across. These should be in order as they appear on the</span>
<span class="sd">                parent Room2D.</span>
<span class="sd">            tolerance: The minimum distance between a vertex and the edge of the</span>
<span class="sd">                wall segment that is considered not touching. (Default: 0.01, suitable</span>
<span class="sd">                for objects in meters).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lengths</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">length</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">segments</span><span class="p">]</span>
        <span class="n">total_len</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">lengths</span><span class="p">)</span>
        <span class="n">new_w_par</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">length</span> <span class="ow">in</span> <span class="n">lengths</span><span class="p">:</span>
            <span class="n">new_w</span> <span class="o">=</span> <span class="p">(</span><span class="n">length</span> <span class="o">/</span> <span class="n">total_len</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span>
            <span class="n">new_w_par</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SingleWindow</span><span class="p">(</span><span class="n">new_w</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sill_height</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_user_data</span><span class="p">(</span><span class="n">new_w_par</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_w_par</span></div>

<div class="viewcode-block" id="SingleWindow.merge"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.SingleWindow.merge">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="n">window_parameters</span><span class="p">,</span> <span class="n">segments</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Merge SingleWindow parameters together using their assigned segments.</span>

<span class="sd">        Args:</span>
<span class="sd">            window_parameters: A list of WindowParameters to be merged.</span>
<span class="sd">            segments: The segments to which the window parameters are assigned.</span>
<span class="sd">                These should be in order as they appear on the parent Room2D.</span>
<span class="sd">            floor_to_ceiling_height: The floor-to-ceiling height of the Room2D</span>
<span class="sd">                to which the segments belong.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">width</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">weights</span><span class="p">,</span> <span class="n">heights</span><span class="p">,</span> <span class="n">sill_heights</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">wp</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">window_parameters</span><span class="p">,</span> <span class="n">segments</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">wp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wp</span><span class="p">,</span> <span class="n">SingleWindow</span><span class="p">):</span>
                    <span class="n">weights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">length</span><span class="p">)</span>
                    <span class="n">width</span> <span class="o">+=</span> <span class="n">wp</span><span class="o">.</span><span class="n">width</span>
                    <span class="n">heights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wp</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
                    <span class="n">sill_heights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wp</span><span class="o">.</span><span class="n">length</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># not all windows are of the same type; convert all to rectangular</span>
                    <span class="k">return</span> <span class="n">_WindowParameterBase</span><span class="o">.</span><span class="n">merge_to_rectangular</span><span class="p">(</span>
                        <span class="n">window_parameters</span><span class="p">,</span> <span class="n">segments</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">)</span>
        <span class="n">tw</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span> <span class="o">/</span> <span class="n">tw</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">weights</span><span class="p">]</span>
        <span class="n">height</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">h</span> <span class="o">*</span> <span class="n">w</span> <span class="k">for</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">heights</span><span class="p">,</span> <span class="n">weights</span><span class="p">)])</span>
        <span class="n">sill_height</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">h</span> <span class="o">*</span> <span class="n">w</span> <span class="k">for</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sill_heights</span><span class="p">,</span> <span class="n">weights</span><span class="p">)])</span>
        <span class="n">new_w</span> <span class="o">=</span> <span class="n">SingleWindow</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">sill_height</span><span class="p">)</span>
        <span class="n">new_w</span><span class="o">.</span><span class="n">_user_data</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">window_parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> \
            <span class="n">window_parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">user_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">new_w</span></div>

<div class="viewcode-block" id="SingleWindow.from_dict"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.SingleWindow.from_dict">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create SingleWindow from a dictionary.</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            {</span>
<span class="sd">            &quot;type&quot;: &quot;SingleWindow&quot;,</span>
<span class="sd">            &quot;width&quot;: 100,</span>
<span class="sd">            &quot;height&quot;: 1.5,</span>
<span class="sd">            &quot;sill_height&quot;: 0.8</span>
<span class="sd">            }</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;SingleWindow&#39;</span><span class="p">,</span> \
            <span class="s1">&#39;Expected SingleWindow dictionary. Got </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">])</span>
        <span class="n">sill</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;sill_height&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;sill_height&#39;</span> <span class="ow">in</span> <span class="n">data</span> <span class="k">else</span> <span class="mi">1</span>
        <span class="n">new_w_par</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">],</span> <span class="n">sill</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;user_data&#39;</span> <span class="ow">in</span> <span class="n">data</span> <span class="ow">and</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;user_data&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">new_w_par</span><span class="o">.</span><span class="n">user_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;user_data&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">new_w_par</span></div>

<div class="viewcode-block" id="SingleWindow.to_dict"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.SingleWindow.to_dict">[docs]</a>    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get SingleWindow as a dictionary.&quot;&quot;&quot;</span>
        <span class="n">base</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;SingleWindow&#39;</span><span class="p">,</span>
            <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
            <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
            <span class="s1">&#39;sill_height&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sill_height</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">base</span><span class="p">[</span><span class="s1">&#39;user_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span>
        <span class="k">return</span> <span class="n">base</span></div>

    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">new_w</span> <span class="o">=</span> <span class="n">SingleWindow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sill_height</span><span class="p">)</span>
        <span class="n">new_w</span><span class="o">.</span><span class="n">_user_data</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">new_w</span>

    <span class="k">def</span> <span class="nf">__key</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A tuple based on the object properties, useful for hashing.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sill_height</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__key</span><span class="p">())</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">SingleWindow</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__key</span><span class="p">()</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">__key</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;SingleWindow: [width: </span><span class="si">{}</span><span class="s1">] [height: </span><span class="si">{}</span><span class="s1">] [sill_height: </span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sill_height</span><span class="p">)</span></div>


<div class="viewcode-block" id="SimpleWindowArea"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.SimpleWindowArea">[docs]</a><span class="k">class</span> <span class="nc">SimpleWindowArea</span><span class="p">(</span><span class="n">_WindowParameterBase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Instructions for a single window defined by an absolute area.</span>

<span class="sd">    Properties:</span>
<span class="sd">        * window_area</span>
<span class="sd">        * user_data</span>

<span class="sd">    Args:</span>
<span class="sd">        window_area: A number for the window area in current model units.</span>
<span class="sd">            If this area is larger than the area of the Wall that it is applied</span>
<span class="sd">            to, the window will fill the parent Wall at a 99% ratio.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_window_area&#39;</span><span class="p">,)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window_area</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize SimpleWindowArea.&quot;&quot;&quot;</span>
        <span class="n">_WindowParameterBase</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="c1"># add the user_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_window_area</span> <span class="o">=</span> <span class="n">float_positive</span><span class="p">(</span><span class="n">window_area</span><span class="p">,</span> <span class="s1">&#39;window area&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">window_area</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a number for the window area in current model units.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_window_area</span>

<div class="viewcode-block" id="SimpleWindowArea.area_from_segment"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.SimpleWindowArea.area_from_segment">[docs]</a>    <span class="k">def</span> <span class="nf">area_from_segment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">segment</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the window area generated by these parameters from a LineSegment3D.</span>

<span class="sd">        Args:</span>
<span class="sd">            segment: A LineSegment3D to which these parameters are applied.</span>
<span class="sd">            floor_to_ceiling_height: The floor-to-ceiling height of the Room2D</span>
<span class="sd">                to which the segment belongs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">wall_area</span> <span class="o">=</span> <span class="n">segment</span><span class="o">.</span><span class="n">length</span> <span class="o">*</span> <span class="n">floor_to_ceiling_height</span> <span class="o">*</span> <span class="mf">0.99</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_area</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_area</span> <span class="o">&lt;</span> <span class="n">wall_area</span> <span class="k">else</span> <span class="n">wall_area</span></div>

<div class="viewcode-block" id="SimpleWindowArea.to_rectangular_windows"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.SimpleWindowArea.to_rectangular_windows">[docs]</a>    <span class="k">def</span> <span class="nf">to_rectangular_windows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">segment</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a version of these WindowParameters as RectangularWindows.</span>

<span class="sd">        Args:</span>
<span class="sd">            segment: A LineSegment3D to which these parameters are applied.</span>
<span class="sd">            floor_to_ceiling_height: The floor-to-ceiling height of the Room2D</span>
<span class="sd">                to which the segment belongs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_window_area</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">wall_area</span> <span class="o">=</span> <span class="n">segment</span><span class="o">.</span><span class="n">length</span> <span class="o">*</span> <span class="n">floor_to_ceiling_height</span> <span class="o">*</span> <span class="mf">0.99</span>
        <span class="n">window_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_area</span> <span class="o">/</span> <span class="n">wall_area</span>
        <span class="n">window_ratio</span> <span class="o">=</span> <span class="mf">0.99</span> <span class="k">if</span> <span class="n">window_ratio</span> <span class="o">&gt;</span> <span class="mf">0.99</span> <span class="k">else</span> <span class="n">window_ratio</span>
        <span class="n">scale_factor</span> <span class="o">=</span> <span class="n">window_ratio</span> <span class="o">**</span> <span class="mf">0.5</span>
        <span class="n">final_height</span> <span class="o">=</span> <span class="n">floor_to_ceiling_height</span> <span class="o">*</span> <span class="n">scale_factor</span>
        <span class="n">final_width</span> <span class="o">=</span> <span class="n">segment</span><span class="o">.</span><span class="n">length</span> <span class="o">*</span> <span class="n">scale_factor</span>
        <span class="n">origin</span> <span class="o">=</span> <span class="n">Point2D</span><span class="p">((</span><span class="n">segment</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span> <span class="n">final_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
                         <span class="p">(</span><span class="n">floor_to_ceiling_height</span> <span class="o">-</span> <span class="n">final_height</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">new_w</span> <span class="o">=</span> <span class="n">RectangularWindows</span><span class="p">([</span><span class="n">origin</span><span class="p">],</span> <span class="p">[</span><span class="n">final_width</span><span class="p">],</span> <span class="p">[</span><span class="n">final_height</span><span class="p">])</span>
        <span class="n">new_w</span><span class="o">.</span><span class="n">_user_data</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">new_w</span></div>

<div class="viewcode-block" id="SimpleWindowArea.add_window_to_face"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.SimpleWindowArea.add_window_to_face">[docs]</a>    <span class="k">def</span> <span class="nf">add_window_to_face</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">face</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add Apertures to a Honeybee Face using these Window Parameters.</span>

<span class="sd">        Args:</span>
<span class="sd">            face: A honeybee-core Face object.</span>
<span class="sd">            tolerance: Optional tolerance value. Default: 0.01, suitable for</span>
<span class="sd">                objects in meters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_window_area</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">window_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_area</span> <span class="o">/</span> <span class="n">face</span><span class="o">.</span><span class="n">area</span>
        <span class="n">window_ratio</span> <span class="o">=</span> <span class="mf">0.99</span> <span class="k">if</span> <span class="n">window_ratio</span> <span class="o">&gt;</span> <span class="mf">0.99</span> <span class="k">else</span> <span class="n">window_ratio</span>
        <span class="n">face</span><span class="o">.</span><span class="n">apertures_by_ratio</span><span class="p">(</span><span class="n">window_ratio</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">)</span>
        <span class="c1"># if the Aperture is interior, set adjacent boundary condition</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">face</span><span class="o">.</span><span class="n">_boundary_condition</span><span class="p">,</span> <span class="n">Surface</span><span class="p">):</span>
            <span class="n">num_aps</span> <span class="o">=</span> <span class="n">face</span><span class="o">.</span><span class="n">apertures</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ap</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">face</span><span class="o">.</span><span class="n">apertures</span><span class="p">):</span>
                <span class="n">ids</span> <span class="o">=</span> <span class="n">face</span><span class="o">.</span><span class="n">_boundary_condition</span><span class="o">.</span><span class="n">boundary_condition_objects</span>
                <span class="n">adj_ap_id</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_Glz</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">num_aps</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">final_ids</span> <span class="o">=</span> <span class="p">(</span><span class="n">adj_ap_id</span><span class="p">,)</span> <span class="o">+</span> <span class="n">ids</span>
                <span class="n">ap</span><span class="o">.</span><span class="n">boundary_condition</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">final_ids</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_apply_user_data_to_honeybee</span><span class="p">(</span><span class="n">face</span><span class="o">.</span><span class="n">apertures</span><span class="p">)</span></div>

<div class="viewcode-block" id="SimpleWindowArea.scale"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.SimpleWindowArea.scale">[docs]</a>    <span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a scaled version of these WindowParameters.</span>

<span class="sd">        This method is called within the scale methods of the Room2D.</span>

<span class="sd">        Args:</span>
<span class="sd">            factor: A number representing how much the object should be scaled.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_w</span> <span class="o">=</span> <span class="n">SimpleWindowArea</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">window_area</span> <span class="o">*</span> <span class="n">factor</span><span class="p">)</span>
        <span class="n">new_w</span><span class="o">.</span><span class="n">_user_data</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">new_w</span></div>

<div class="viewcode-block" id="SimpleWindowArea.split"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.SimpleWindowArea.split">[docs]</a>    <span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">segments</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Split SimpleWindowArea parameters across a list of ordered segments.</span>

<span class="sd">        Args:</span>
<span class="sd">            segments: The segments to which the window parameters are being</span>
<span class="sd">                split across. These should be in order as they appear on the</span>
<span class="sd">                parent Room2D.</span>
<span class="sd">            tolerance: The minimum distance between a vertex and the edge of the</span>
<span class="sd">                wall segment that is considered not touching. (Default: 0.01, suitable</span>
<span class="sd">                for objects in meters).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># if one of the segments is much larger than the others, add all windows to that</span>
        <span class="n">lengths</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">length</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">segments</span><span class="p">]</span>
        <span class="n">new_wps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_all_to_primary_segment</span><span class="p">(</span><span class="n">lengths</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">new_wps</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">new_wps</span>
        <span class="c1"># otherwise, just distribute the windows evenly</span>
        <span class="n">total_len</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">lengths</span><span class="p">)</span>
        <span class="n">n_par</span> <span class="o">=</span> <span class="p">[</span><span class="n">SimpleWindowArea</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">window_area</span> <span class="o">*</span> <span class="p">(</span><span class="n">sl</span> <span class="o">/</span> <span class="n">total_len</span><span class="p">))</span> <span class="k">for</span> <span class="n">sl</span> <span class="ow">in</span> <span class="n">lengths</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_user_data</span><span class="p">(</span><span class="n">n_par</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">n_par</span></div>

<div class="viewcode-block" id="SimpleWindowArea.merge"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.SimpleWindowArea.merge">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="n">window_parameters</span><span class="p">,</span> <span class="n">segments</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Merge SimpleWindowArea parameters together using their assigned segments.</span>

<span class="sd">        Args:</span>
<span class="sd">            window_parameters: A list of WindowParameters to be merged.</span>
<span class="sd">            segments: The segments to which the window parameters are assigned.</span>
<span class="sd">                These should be in order as they appear on the parent Room2D.</span>
<span class="sd">            floor_to_ceiling_height: The floor-to-ceiling height of the Room2D</span>
<span class="sd">                to which the segments belong.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">win_area</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">wp</span> <span class="ow">in</span> <span class="n">window_parameters</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">wp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wp</span><span class="p">,</span> <span class="n">SimpleWindowArea</span><span class="p">):</span>
                    <span class="n">win_area</span> <span class="o">+=</span> <span class="n">wp</span><span class="o">.</span><span class="n">window_area</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># not all windows are of the same type; convert all to rectangular</span>
                    <span class="k">return</span> <span class="n">_WindowParameterBase</span><span class="o">.</span><span class="n">merge_to_rectangular</span><span class="p">(</span>
                        <span class="n">window_parameters</span><span class="p">,</span> <span class="n">segments</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">)</span>
        <span class="n">new_w</span> <span class="o">=</span> <span class="n">SimpleWindowArea</span><span class="p">(</span><span class="n">win_area</span><span class="p">)</span>
        <span class="n">new_w</span><span class="o">.</span><span class="n">_user_data</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">window_parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> \
            <span class="n">window_parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">user_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">new_w</span></div>

<div class="viewcode-block" id="SimpleWindowArea.from_dict"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.SimpleWindowArea.from_dict">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create SimpleWindowArea from a dictionary.</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            {</span>
<span class="sd">            &quot;type&quot;: &quot;SimpleWindowArea&quot;,</span>
<span class="sd">            &quot;window_area&quot;: 5.5</span>
<span class="sd">            }</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;SimpleWindowArea&#39;</span><span class="p">,</span> \
            <span class="s1">&#39;Expected SimpleWindowArea dictionary. Got </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">])</span>
        <span class="n">new_w_par</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;window_area&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s1">&#39;user_data&#39;</span> <span class="ow">in</span> <span class="n">data</span> <span class="ow">and</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;user_data&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">new_w_par</span><span class="o">.</span><span class="n">user_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;user_data&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">new_w_par</span></div>

<div class="viewcode-block" id="SimpleWindowArea.to_dict"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.SimpleWindowArea.to_dict">[docs]</a>    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get SimpleWindowArea as a dictionary.&quot;&quot;&quot;</span>
        <span class="n">base</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;SimpleWindowArea&#39;</span><span class="p">,</span>
            <span class="s1">&#39;window_area&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_area</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">base</span><span class="p">[</span><span class="s1">&#39;user_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span>
        <span class="k">return</span> <span class="n">base</span></div>

    <span class="k">def</span> <span class="nf">_all_to_primary_segment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lengths</span><span class="p">,</span> <span class="n">prim_ratio</span><span class="o">=</span><span class="mf">0.95</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Determine if one segment is primary and should get all the windows.&quot;&quot;&quot;</span>
        <span class="n">total_len</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">lengths</span><span class="p">)</span>
        <span class="n">prim_len</span> <span class="o">=</span> <span class="n">prim_ratio</span> <span class="o">+</span> <span class="mf">0.01</span>
        <span class="n">all_to_one_i</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sl</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lengths</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">sl</span> <span class="o">/</span> <span class="n">total_len</span> <span class="o">&gt;</span> <span class="n">prim_len</span><span class="p">:</span>
                <span class="n">all_to_one_i</span> <span class="o">=</span> <span class="n">i</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">all_to_one_i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">new_wps</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">lengths</span><span class="p">)</span>
            <span class="n">new_par</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">duplicate</span><span class="p">()</span>
            <span class="n">new_wps</span><span class="p">[</span><span class="n">all_to_one_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_par</span>
            <span class="k">return</span> <span class="n">new_wps</span>

    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">new_w</span> <span class="o">=</span> <span class="n">SimpleWindowArea</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">window_area</span><span class="p">)</span>
        <span class="n">new_w</span><span class="o">.</span><span class="n">_user_data</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">new_w</span>

    <span class="k">def</span> <span class="nf">__key</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A tuple based on the object properties, useful for hashing.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_window_area</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__key</span><span class="p">())</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">SimpleWindowArea</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__key</span><span class="p">()</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">__key</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;SimpleWindowArea: [area: </span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">window_area</span><span class="p">)</span></div>


<div class="viewcode-block" id="SimpleWindowRatio"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.SimpleWindowRatio">[docs]</a><span class="k">class</span> <span class="nc">SimpleWindowRatio</span><span class="p">(</span><span class="n">_WindowParameterBase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Instructions for a single window defined by an area ratio with the base wall.</span>

<span class="sd">    Properties:</span>
<span class="sd">        * window_ratio</span>
<span class="sd">        * user_data</span>

<span class="sd">    Args:</span>
<span class="sd">        window_ratio: A number between 0 and 1 for the ratio between the window</span>
<span class="sd">            area and the parent wall surface area.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_window_ratio&#39;</span><span class="p">,)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window_ratio</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize SimpleWindowRatio.&quot;&quot;&quot;</span>
        <span class="n">_WindowParameterBase</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="c1"># add the user_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_window_ratio</span> <span class="o">=</span> <span class="n">float_in_range</span><span class="p">(</span><span class="n">window_ratio</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;window ratio&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">window_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a number between 0 and 1 for the window ratio.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_window_ratio</span>

<div class="viewcode-block" id="SimpleWindowRatio.area_from_segment"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.SimpleWindowRatio.area_from_segment">[docs]</a>    <span class="k">def</span> <span class="nf">area_from_segment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">segment</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the window area generated by these parameters from a LineSegment3D.</span>

<span class="sd">        Args:</span>
<span class="sd">            segment: A LineSegment3D to which these parameters are applied.</span>
<span class="sd">            floor_to_ceiling_height: The floor-to-ceiling height of the Room2D</span>
<span class="sd">                to which the segment belongs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">segment</span><span class="o">.</span><span class="n">length</span> <span class="o">*</span> <span class="n">floor_to_ceiling_height</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_window_ratio</span></div>

<div class="viewcode-block" id="SimpleWindowRatio.to_rectangular_windows"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.SimpleWindowRatio.to_rectangular_windows">[docs]</a>    <span class="k">def</span> <span class="nf">to_rectangular_windows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">segment</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a version of these WindowParameters as RectangularWindows.</span>

<span class="sd">        Args:</span>
<span class="sd">            segment: A LineSegment3D to which these parameters are applied.</span>
<span class="sd">            floor_to_ceiling_height: The floor-to-ceiling height of the Room2D</span>
<span class="sd">                to which the segment belongs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_window_ratio</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">scale_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_ratio</span> <span class="o">**</span> <span class="mf">0.5</span>
        <span class="n">final_height</span> <span class="o">=</span> <span class="n">floor_to_ceiling_height</span> <span class="o">*</span> <span class="n">scale_factor</span>
        <span class="n">final_width</span> <span class="o">=</span> <span class="n">segment</span><span class="o">.</span><span class="n">length</span> <span class="o">*</span> <span class="n">scale_factor</span>
        <span class="n">origin</span> <span class="o">=</span> <span class="n">Point2D</span><span class="p">((</span><span class="n">segment</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span> <span class="n">final_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
                         <span class="p">(</span><span class="n">floor_to_ceiling_height</span> <span class="o">-</span> <span class="n">final_height</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">new_w</span> <span class="o">=</span> <span class="n">RectangularWindows</span><span class="p">([</span><span class="n">origin</span><span class="p">],</span> <span class="p">[</span><span class="n">final_width</span><span class="p">],</span> <span class="p">[</span><span class="n">final_height</span><span class="p">])</span>
        <span class="n">new_w</span><span class="o">.</span><span class="n">_user_data</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">new_w</span></div>

<div class="viewcode-block" id="SimpleWindowRatio.add_window_to_face"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.SimpleWindowRatio.add_window_to_face">[docs]</a>    <span class="k">def</span> <span class="nf">add_window_to_face</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">face</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add Apertures to a Honeybee Face using these Window Parameters.</span>

<span class="sd">        Args:</span>
<span class="sd">            face: A honeybee-core Face object.</span>
<span class="sd">            tolerance: Optional tolerance value. Default: 0.01, suitable for</span>
<span class="sd">                objects in meters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_window_ratio</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">scale_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_ratio</span> <span class="o">**</span> <span class="mf">.5</span>
        <span class="n">ap_face</span> <span class="o">=</span> <span class="n">face</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">scale_factor</span><span class="p">,</span> <span class="n">face</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">center</span><span class="p">)</span>
        <span class="n">aperture</span> <span class="o">=</span> <span class="n">Aperture</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_Glz1&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">face</span><span class="o">.</span><span class="n">identifier</span><span class="p">),</span> <span class="n">ap_face</span><span class="p">)</span>
        <span class="n">aperture</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">face</span>
        <span class="n">face</span><span class="o">.</span><span class="n">add_aperture</span><span class="p">(</span><span class="n">aperture</span><span class="p">)</span>
        <span class="c1"># if the Aperture is interior, set adjacent boundary condition</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">face</span><span class="o">.</span><span class="n">_boundary_condition</span><span class="p">,</span> <span class="n">Surface</span><span class="p">):</span>
            <span class="n">ids</span> <span class="o">=</span> <span class="n">face</span><span class="o">.</span><span class="n">_boundary_condition</span><span class="o">.</span><span class="n">boundary_condition_objects</span>
            <span class="n">adj_ap_id</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_Glz1&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ids</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">final_ids</span> <span class="o">=</span> <span class="p">(</span><span class="n">adj_ap_id</span><span class="p">,)</span> <span class="o">+</span> <span class="n">ids</span>
            <span class="n">aperture</span><span class="o">.</span><span class="n">boundary_condition</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">final_ids</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_apply_user_data_to_honeybee</span><span class="p">(</span><span class="n">face</span><span class="o">.</span><span class="n">apertures</span><span class="p">)</span></div>

<div class="viewcode-block" id="SimpleWindowRatio.split"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.SimpleWindowRatio.split">[docs]</a>    <span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">segments</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Split SimpleWindowRatio parameters across a list of ordered segments.</span>

<span class="sd">        Args:</span>
<span class="sd">            segments: The segments to which the window parameters are being</span>
<span class="sd">                split across. These should be in order as they appear on the</span>
<span class="sd">                parent Room2D.</span>
<span class="sd">            tolerance: The minimum distance between a vertex and the edge of the</span>
<span class="sd">                wall segment that is considered not touching. (Default: 0.01, suitable</span>
<span class="sd">                for objects in meters).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># if one of the segments is much larger than the others, add all windows to that</span>
        <span class="n">new_ratios</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_all_to_primary_segment</span><span class="p">(</span><span class="n">segments</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">new_ratios</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">new_ratios</span>
        <span class="c1"># otherwise, just distribute the windows evenly</span>
        <span class="n">new_w_par</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">segments</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_user_data</span><span class="p">(</span><span class="n">new_w_par</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_w_par</span></div>

<div class="viewcode-block" id="SimpleWindowRatio.merge"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.SimpleWindowRatio.merge">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="n">window_parameters</span><span class="p">,</span> <span class="n">segments</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Merge SimpleWindowRatio parameters together using their assigned segments.</span>

<span class="sd">        Args:</span>
<span class="sd">            window_parameters: A list of WindowParameters to be merged.</span>
<span class="sd">            segments: The segments to which the window parameters are assigned.</span>
<span class="sd">                These should be in order as they appear on the parent Room2D.</span>
<span class="sd">            floor_to_ceiling_height: The floor-to-ceiling height of the Room2D</span>
<span class="sd">                to which the segments belong.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">win_area</span><span class="p">,</span> <span class="n">wall_area</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">wp</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">window_parameters</span><span class="p">,</span> <span class="n">segments</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">wp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">wall_a</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">length</span> <span class="o">*</span> <span class="n">floor_to_ceiling_height</span>
                <span class="n">wall_area</span> <span class="o">+=</span> <span class="n">wall_a</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wp</span><span class="p">,</span> <span class="n">SimpleWindowRatio</span><span class="p">):</span>
                    <span class="n">win_area</span> <span class="o">+=</span> <span class="p">(</span><span class="n">wall_area</span> <span class="o">*</span> <span class="n">wp</span><span class="o">.</span><span class="n">window_ratio</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># not all windows are of the same type; convert all to rectangular</span>
                    <span class="k">return</span> <span class="n">_WindowParameterBase</span><span class="o">.</span><span class="n">merge_to_rectangular</span><span class="p">(</span>
                        <span class="n">window_parameters</span><span class="p">,</span> <span class="n">segments</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">)</span>
        <span class="n">new_w</span> <span class="o">=</span> <span class="n">SimpleWindowRatio</span><span class="p">(</span><span class="n">win_area</span> <span class="o">/</span> <span class="n">wall_area</span><span class="p">)</span>
        <span class="n">new_w</span><span class="o">.</span><span class="n">_user_data</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">window_parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> \
            <span class="n">window_parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">user_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">new_w</span></div>

<div class="viewcode-block" id="SimpleWindowRatio.from_dict"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.SimpleWindowRatio.from_dict">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create SimpleWindowRatio from a dictionary.</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            {</span>
<span class="sd">            &quot;type&quot;: &quot;SimpleWindowRatio&quot;,</span>
<span class="sd">            &quot;window_ratio&quot;: 0.4</span>
<span class="sd">            }</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;SimpleWindowRatio&#39;</span><span class="p">,</span> \
            <span class="s1">&#39;Expected SimpleWindowRatio dictionary. Got </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">])</span>
        <span class="n">new_w_par</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;window_ratio&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s1">&#39;user_data&#39;</span> <span class="ow">in</span> <span class="n">data</span> <span class="ow">and</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;user_data&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">new_w_par</span><span class="o">.</span><span class="n">user_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;user_data&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">new_w_par</span></div>

<div class="viewcode-block" id="SimpleWindowRatio.to_dict"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.SimpleWindowRatio.to_dict">[docs]</a>    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get SimpleWindowRatio as a dictionary.&quot;&quot;&quot;</span>
        <span class="n">base</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;SimpleWindowRatio&#39;</span><span class="p">,</span>
            <span class="s1">&#39;window_ratio&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_ratio</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">base</span><span class="p">[</span><span class="s1">&#39;user_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span>
        <span class="k">return</span> <span class="n">base</span></div>

    <span class="k">def</span> <span class="nf">_all_to_primary_segment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">segments</span><span class="p">,</span> <span class="n">prim_ratio</span><span class="o">=</span><span class="mf">0.95</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Determine if one segment is primary and should get all the windows.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_ratio</span> <span class="o">&lt;=</span> <span class="n">prim_ratio</span><span class="p">:</span>
            <span class="n">lengths</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">length</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">segments</span><span class="p">]</span>
            <span class="n">total_len</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">lengths</span><span class="p">)</span>
            <span class="n">prim_len</span> <span class="o">=</span> <span class="n">prim_ratio</span> <span class="o">+</span> <span class="mf">0.01</span>
            <span class="n">all_to_one_i</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sl</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lengths</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">sl</span> <span class="o">/</span> <span class="n">total_len</span> <span class="o">&gt;</span> <span class="n">prim_len</span><span class="p">:</span>
                    <span class="n">all_to_one_i</span> <span class="o">=</span> <span class="n">i</span>
                    <span class="n">all_to_one_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_ratio</span> <span class="o">*</span> <span class="p">(</span><span class="n">total_len</span> <span class="o">/</span> <span class="n">sl</span><span class="p">)</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="n">all_to_one_i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">new_ratios</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">segments</span><span class="p">)</span>
                <span class="n">new_par</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">duplicate</span><span class="p">()</span>
                <span class="n">new_par</span><span class="o">.</span><span class="n">_window_ratio</span> <span class="o">=</span> <span class="n">all_to_one_ratio</span>
                <span class="n">new_ratios</span><span class="p">[</span><span class="n">all_to_one_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_par</span>
                <span class="k">return</span> <span class="n">new_ratios</span>

    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">new_w</span> <span class="o">=</span> <span class="n">SimpleWindowRatio</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">window_ratio</span><span class="p">)</span>
        <span class="n">new_w</span><span class="o">.</span><span class="n">_user_data</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">new_w</span>

    <span class="k">def</span> <span class="nf">__key</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A tuple based on the object properties, useful for hashing.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_window_ratio</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__key</span><span class="p">())</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">SimpleWindowRatio</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__key</span><span class="p">()</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">__key</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;SimpleWindowRatio: [ratio: </span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">window_ratio</span><span class="p">)</span></div>


<div class="viewcode-block" id="RepeatingWindowRatio"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.RepeatingWindowRatio">[docs]</a><span class="k">class</span> <span class="nc">RepeatingWindowRatio</span><span class="p">(</span><span class="n">SimpleWindowRatio</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Instructions for repeating windows derived from an area ratio with the base face.</span>

<span class="sd">    Args:</span>
<span class="sd">        window_ratio: A number between 0 and 0.95 for the ratio between the window</span>
<span class="sd">            area and the total facade area.</span>
<span class="sd">        window_height: A number for the target height of the windows.</span>
<span class="sd">            Note that, if the window ratio is too large for the height, the</span>
<span class="sd">            ratio will take precedence and the actual window_height will</span>
<span class="sd">            be larger than this value.</span>
<span class="sd">        sill_height: A number for the target height above the bottom edge of</span>
<span class="sd">            the rectangle to start the windows. Note that, if the</span>
<span class="sd">            ratio is too large for the height, the ratio will take precedence</span>
<span class="sd">            and the sill_height will be smaller than this value.</span>
<span class="sd">        horizontal_separation: A number for the target separation between</span>
<span class="sd">            individual window center lines.  If this number is larger than</span>
<span class="sd">            the parent rectangle base, only one window will be produced.</span>
<span class="sd">        vertical_separation: An optional number to create a single vertical</span>
<span class="sd">            separation between top and bottom windows. Default: 0.</span>

<span class="sd">    Properties:</span>
<span class="sd">        * window_ratio</span>
<span class="sd">        * window_height</span>
<span class="sd">        * sill_height</span>
<span class="sd">        * horizontal_separation</span>
<span class="sd">        * vertical_separation</span>
<span class="sd">        * user_data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_window_height&#39;</span><span class="p">,</span> <span class="s1">&#39;_sill_height&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;_horizontal_separation&#39;</span><span class="p">,</span> <span class="s1">&#39;_vertical_separation&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window_ratio</span><span class="p">,</span> <span class="n">window_height</span><span class="p">,</span> <span class="n">sill_height</span><span class="p">,</span>
                 <span class="n">horizontal_separation</span><span class="p">,</span> <span class="n">vertical_separation</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize RepeatingWindowRatio.&quot;&quot;&quot;</span>
        <span class="n">_WindowParameterBase</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="c1"># add the user_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_window_ratio</span> <span class="o">=</span> <span class="n">float_in_range</span><span class="p">(</span><span class="n">window_ratio</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="s1">&#39;window ratio&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_window_height</span> <span class="o">=</span> <span class="n">float_positive</span><span class="p">(</span><span class="n">window_height</span><span class="p">,</span> <span class="s1">&#39;window height&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sill_height</span> <span class="o">=</span> <span class="n">float_positive</span><span class="p">(</span><span class="n">sill_height</span><span class="p">,</span> <span class="s1">&#39;sill height&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_horizontal_separation</span> <span class="o">=</span> \
            <span class="n">float_positive</span><span class="p">(</span><span class="n">horizontal_separation</span><span class="p">,</span> <span class="s1">&#39;window horizontal separation&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vertical_separation</span> <span class="o">=</span> \
            <span class="n">float_positive</span><span class="p">(</span><span class="n">vertical_separation</span><span class="p">,</span> <span class="s1">&#39;window vertical separation&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">window_height</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a number or the target height of the windows.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_window_height</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sill_height</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a number for the height above the bottom edge of the floor.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sill_height</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">horizontal_separation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a number for the separation between individual window center lines.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_horizontal_separation</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">vertical_separation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a number for a vertical separation between top/bottom windows.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vertical_separation</span>

<div class="viewcode-block" id="RepeatingWindowRatio.to_rectangular_windows"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.RepeatingWindowRatio.to_rectangular_windows">[docs]</a>    <span class="k">def</span> <span class="nf">to_rectangular_windows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">segment</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a version of these WindowParameters as RectangularWindows.</span>

<span class="sd">        Args:</span>
<span class="sd">            segment: A LineSegment3D to which these parameters are applied.</span>
<span class="sd">            floor_to_ceiling_height: The floor-to-ceiling height of the Room2D</span>
<span class="sd">                to which the segment belongs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_window_ratio</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">base_plane</span> <span class="o">=</span> <span class="n">Plane</span><span class="p">(</span><span class="n">segment</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">rotate_xy</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="n">segment</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="n">segment</span><span class="o">.</span><span class="n">v</span><span class="p">)</span>
        <span class="n">sub_rects</span> <span class="o">=</span> <span class="n">Face3D</span><span class="o">.</span><span class="n">sub_rects_from_rect_ratio</span><span class="p">(</span>
            <span class="n">base_plane</span><span class="p">,</span> <span class="n">segment</span><span class="o">.</span><span class="n">length</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">window_ratio</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sill_height</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">horizontal_separation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertical_separation</span>
        <span class="p">)</span>
        <span class="n">origins</span><span class="p">,</span> <span class="n">widths</span><span class="p">,</span> <span class="n">heights</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">rect</span> <span class="ow">in</span> <span class="n">sub_rects</span><span class="p">:</span>
            <span class="n">poly</span> <span class="o">=</span> <span class="n">Polygon2D</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">base_plane</span><span class="o">.</span><span class="n">xyz_to_xy</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">rect</span><span class="p">))</span>
            <span class="n">min_pt</span><span class="p">,</span> <span class="n">max_pt</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">max</span>
            <span class="n">origins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">min_pt</span><span class="p">)</span>
            <span class="n">widths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">max_pt</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">min_pt</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
            <span class="n">heights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">max_pt</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">min_pt</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="n">new_w</span> <span class="o">=</span> <span class="n">RectangularWindows</span><span class="p">(</span><span class="n">origins</span><span class="p">,</span> <span class="n">widths</span><span class="p">,</span> <span class="n">heights</span><span class="p">)</span>
        <span class="n">new_w</span><span class="o">.</span><span class="n">_user_data</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">new_w</span></div>

<div class="viewcode-block" id="RepeatingWindowRatio.add_window_to_face"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.RepeatingWindowRatio.add_window_to_face">[docs]</a>    <span class="k">def</span> <span class="nf">add_window_to_face</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">face</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add Apertures to a Honeybee Face using these Window Parameters.</span>

<span class="sd">        Args:</span>
<span class="sd">            face: A honeybee-core Face object.</span>
<span class="sd">            tolerance: The maximum difference between point values for them to be</span>
<span class="sd">                considered a part of a rectangle. Default: 0.01, suitable for</span>
<span class="sd">                objects in meters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_window_ratio</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">face</span><span class="o">.</span><span class="n">apertures_by_ratio_rectangle</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">window_ratio</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sill_height</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">horizontal_separation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertical_separation</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">)</span>
        <span class="c1"># if the Aperture is interior, set adjacent boundary condition</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">face</span><span class="o">.</span><span class="n">_boundary_condition</span><span class="p">,</span> <span class="n">Surface</span><span class="p">):</span>
            <span class="n">num_aps</span> <span class="o">=</span> <span class="n">face</span><span class="o">.</span><span class="n">apertures</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ap</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">face</span><span class="o">.</span><span class="n">apertures</span><span class="p">):</span>
                <span class="n">ids</span> <span class="o">=</span> <span class="n">face</span><span class="o">.</span><span class="n">_boundary_condition</span><span class="o">.</span><span class="n">boundary_condition_objects</span>
                <span class="n">adj_ap_id</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_Glz</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">num_aps</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">final_ids</span> <span class="o">=</span> <span class="p">(</span><span class="n">adj_ap_id</span><span class="p">,)</span> <span class="o">+</span> <span class="n">ids</span>
                <span class="n">ap</span><span class="o">.</span><span class="n">boundary_condition</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">final_ids</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_apply_user_data_to_honeybee</span><span class="p">(</span><span class="n">face</span><span class="o">.</span><span class="n">apertures</span><span class="p">)</span></div>

<div class="viewcode-block" id="RepeatingWindowRatio.scale"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.RepeatingWindowRatio.scale">[docs]</a>    <span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a scaled version of these WindowParameters.</span>

<span class="sd">        This method is called within the scale methods of the Room2D.</span>

<span class="sd">        Args:</span>
<span class="sd">            factor: A number representing how much the object should be scaled.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_w</span> <span class="o">=</span> <span class="n">RepeatingWindowRatio</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">window_ratio</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_height</span> <span class="o">*</span> <span class="n">factor</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sill_height</span> <span class="o">*</span> <span class="n">factor</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">horizontal_separation</span> <span class="o">*</span> <span class="n">factor</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertical_separation</span> <span class="o">*</span> <span class="n">factor</span><span class="p">)</span>
        <span class="n">new_w</span><span class="o">.</span><span class="n">_user_data</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">new_w</span></div>

<div class="viewcode-block" id="RepeatingWindowRatio.split"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.RepeatingWindowRatio.split">[docs]</a>    <span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">segments</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Split RepeatingWindowRatio parameters across a list of ordered segments.</span>

<span class="sd">        Args:</span>
<span class="sd">            segments: The segments to which the window parameters are being</span>
<span class="sd">                split across. These should be in order as they appear on the</span>
<span class="sd">                parent Room2D.</span>
<span class="sd">            tolerance: The minimum distance between a vertex and the edge of the</span>
<span class="sd">                wall segment that is considered not touching. (Default: 0.01, suitable</span>
<span class="sd">                for objects in meters).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># if one of the segments is much larger than the others, add all windows to that</span>
        <span class="n">new_ratios</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_all_to_primary_segment</span><span class="p">(</span><span class="n">segments</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">new_ratios</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">new_ratios</span>
        <span class="c1"># otherwise, just distribute the windows evenly</span>
        <span class="n">new_w_par</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">segments</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_user_data</span><span class="p">(</span><span class="n">new_w_par</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_w_par</span></div>

<div class="viewcode-block" id="RepeatingWindowRatio.merge"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.RepeatingWindowRatio.merge">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="n">window_parameters</span><span class="p">,</span> <span class="n">segments</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Merge RepeatingWindowRatio parameters together using their assigned segments.</span>

<span class="sd">        Args:</span>
<span class="sd">            window_parameters: A list of WindowParameters to be merged.</span>
<span class="sd">            segments: The segments to which the window parameters are assigned.</span>
<span class="sd">                These should be in order as they appear on the parent Room2D.</span>
<span class="sd">            floor_to_ceiling_height: The floor-to-ceiling height of the Room2D</span>
<span class="sd">                to which the segments belong.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">weights</span><span class="p">,</span> <span class="n">heights</span><span class="p">,</span> <span class="n">sill_heights</span><span class="p">,</span> <span class="n">h_seps</span><span class="p">,</span> <span class="n">v_seps</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="n">win_area</span><span class="p">,</span> <span class="n">wall_area</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">wp</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">window_parameters</span><span class="p">,</span> <span class="n">segments</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">wp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">wall_a</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">length</span> <span class="o">*</span> <span class="n">floor_to_ceiling_height</span>
                <span class="n">wall_area</span> <span class="o">+=</span> <span class="n">wall_a</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wp</span><span class="p">,</span> <span class="n">RepeatingWindowRatio</span><span class="p">):</span>
                    <span class="n">win_area</span> <span class="o">+=</span> <span class="p">(</span><span class="n">wall_area</span> <span class="o">*</span> <span class="n">wp</span><span class="o">.</span><span class="n">window_ratio</span><span class="p">)</span>
                    <span class="n">weights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">length</span><span class="p">)</span>
                    <span class="n">heights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wp</span><span class="o">.</span><span class="n">window_height</span><span class="p">)</span>
                    <span class="n">sill_heights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wp</span><span class="o">.</span><span class="n">sill_height</span><span class="p">)</span>
                    <span class="n">h_seps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wp</span><span class="o">.</span><span class="n">horizontal_separation</span><span class="p">)</span>
                    <span class="n">v_seps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wp</span><span class="o">.</span><span class="n">vertical_separation</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># not all windows are of the same type; convert all to rectangular</span>
                    <span class="k">return</span> <span class="n">_WindowParameterBase</span><span class="o">.</span><span class="n">merge_to_rectangular</span><span class="p">(</span>
                        <span class="n">window_parameters</span><span class="p">,</span> <span class="n">segments</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">)</span>
        <span class="n">window_ratio</span> <span class="o">=</span> <span class="n">win_area</span> <span class="o">/</span> <span class="n">wall_area</span>
        <span class="n">tw</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span> <span class="o">/</span> <span class="n">tw</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">weights</span><span class="p">]</span>
        <span class="n">height</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">h</span> <span class="o">*</span> <span class="n">w</span> <span class="k">for</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">heights</span><span class="p">,</span> <span class="n">weights</span><span class="p">)])</span>
        <span class="n">sill_height</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">h</span> <span class="o">*</span> <span class="n">w</span> <span class="k">for</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sill_heights</span><span class="p">,</span> <span class="n">weights</span><span class="p">)])</span>
        <span class="n">h_sep</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">s</span> <span class="o">*</span> <span class="n">w</span> <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">h_seps</span><span class="p">,</span> <span class="n">weights</span><span class="p">)])</span>
        <span class="n">v_sep</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">s</span> <span class="o">*</span> <span class="n">w</span> <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">v_seps</span><span class="p">,</span> <span class="n">weights</span><span class="p">)])</span>
        <span class="n">new_w</span> <span class="o">=</span> <span class="n">RepeatingWindowRatio</span><span class="p">(</span><span class="n">window_ratio</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">sill_height</span><span class="p">,</span> <span class="n">h_sep</span><span class="p">,</span> <span class="n">v_sep</span><span class="p">)</span>
        <span class="n">new_w</span><span class="o">.</span><span class="n">_user_data</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">window_parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> \
            <span class="n">window_parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">user_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">new_w</span></div>

<div class="viewcode-block" id="RepeatingWindowRatio.from_dict"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.RepeatingWindowRatio.from_dict">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create RepeatingWindowRatio from a dictionary.</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            {</span>
<span class="sd">            &quot;type&quot;: &quot;RepeatingWindowRatio&quot;,</span>
<span class="sd">            &quot;window_ratio&quot;: 0.4,</span>
<span class="sd">            &quot;window_height&quot;: 2,</span>
<span class="sd">            &quot;sill_height&quot;: 0.8,</span>
<span class="sd">            &quot;horizontal_separation&quot;: 4,</span>
<span class="sd">            &quot;vertical_separation&quot;: 0.5</span>
<span class="sd">            }</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;RepeatingWindowRatio&#39;</span><span class="p">,</span> \
            <span class="s1">&#39;Expected RepeatingWindowRatio dictionary. Got </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">])</span>
        <span class="n">vert</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;vertical_separation&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;vertical_separation&#39;</span> <span class="ow">in</span> <span class="n">data</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">new_w_par</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;window_ratio&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;window_height&#39;</span><span class="p">],</span>
                        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;sill_height&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;horizontal_separation&#39;</span><span class="p">],</span> <span class="n">vert</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;user_data&#39;</span> <span class="ow">in</span> <span class="n">data</span> <span class="ow">and</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;user_data&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">new_w_par</span><span class="o">.</span><span class="n">user_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;user_data&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">new_w_par</span></div>

<div class="viewcode-block" id="RepeatingWindowRatio.to_dict"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.RepeatingWindowRatio.to_dict">[docs]</a>    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get RepeatingWindowRatio as a dictionary.&quot;&quot;&quot;</span>
        <span class="n">base</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;RepeatingWindowRatio&#39;</span><span class="p">,</span>
            <span class="s1">&#39;window_ratio&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_ratio</span><span class="p">,</span>
            <span class="s1">&#39;window_height&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_height</span><span class="p">,</span>
            <span class="s1">&#39;sill_height&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sill_height</span><span class="p">,</span>
            <span class="s1">&#39;horizontal_separation&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">horizontal_separation</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertical_separation</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">base</span><span class="p">[</span><span class="s1">&#39;vertical_separation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertical_separation</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">base</span><span class="p">[</span><span class="s1">&#39;user_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span>
        <span class="k">return</span> <span class="n">base</span></div>

    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">new_w</span> <span class="o">=</span> <span class="n">RepeatingWindowRatio</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_window_ratio</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_window_height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sill_height</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_horizontal_separation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vertical_separation</span><span class="p">)</span>
        <span class="n">new_w</span><span class="o">.</span><span class="n">_user_data</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">new_w</span>

    <span class="k">def</span> <span class="nf">__key</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A tuple based on the object properties, useful for hashing.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_window_ratio</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_window_height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sill_height</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_horizontal_separation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vertical_separation</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__key</span><span class="p">())</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">RepeatingWindowRatio</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__key</span><span class="p">()</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">__key</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;RepeatingWindowRatio: [ratio: </span><span class="si">{}</span><span class="s1">] [window_height: </span><span class="si">{}</span><span class="s1">] [sill_height:&#39;</span> \
            <span class="s1">&#39; </span><span class="si">{}</span><span class="s1">] [horizontal: </span><span class="si">{}</span><span class="s1">] [vertical: </span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_window_ratio</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sill_height</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">horizontal_separation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertical_separation</span><span class="p">)</span></div>


<div class="viewcode-block" id="RepeatingWindowWidthHeight"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.RepeatingWindowWidthHeight">[docs]</a><span class="k">class</span> <span class="nc">RepeatingWindowWidthHeight</span><span class="p">(</span><span class="n">_WindowParameterBase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Instructions for repeating rectangular windows of a fixed width and height.</span>

<span class="sd">    This class effectively fills a wall with windows at the specified width, height</span>
<span class="sd">    and separation.</span>

<span class="sd">    Args:</span>
<span class="sd">        window_height: A number for the target height of the windows.</span>
<span class="sd">            Note that, if the window_height is larger than the height of the wall,</span>
<span class="sd">            the generated windows will have a height equal to the wall height</span>
<span class="sd">            in order to avoid having windows extend outside the wall face.</span>
<span class="sd">        window_width: A number for the target width of the windows.</span>
<span class="sd">            Note that, if the window_width is larger than the width of the wall,</span>
<span class="sd">            the generated windows will have a width equal to the wall width</span>
<span class="sd">            in order to avoid having windows extend outside the wall face.</span>
<span class="sd">        sill_height: A number for the target height above the bottom edge of</span>
<span class="sd">            the wall to start the windows. If the window_height</span>
<span class="sd">            is too large for the sill_height to fit within the rectangle,</span>
<span class="sd">            the window_height will take precedence.</span>
<span class="sd">        horizontal_separation: A number for the target separation between</span>
<span class="sd">            individual window center lines.  If this number is larger than</span>
<span class="sd">            the parent rectangle base, only one window will be produced.</span>

<span class="sd">    Properties:</span>
<span class="sd">        * window_height</span>
<span class="sd">        * window_width</span>
<span class="sd">        * sill_height</span>
<span class="sd">        * horizontal_separation</span>
<span class="sd">        * user_data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_window_height&#39;</span><span class="p">,</span> <span class="s1">&#39;_window_width&#39;</span><span class="p">,</span> <span class="s1">&#39;_sill_height&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;_horizontal_separation&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window_height</span><span class="p">,</span> <span class="n">window_width</span><span class="p">,</span> <span class="n">sill_height</span><span class="p">,</span> <span class="n">horizontal_separation</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize RepeatingWindowWidthHeight.&quot;&quot;&quot;</span>
        <span class="n">_WindowParameterBase</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="c1"># add the user_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_window_height</span> <span class="o">=</span> <span class="n">float_positive</span><span class="p">(</span><span class="n">window_height</span><span class="p">,</span> <span class="s1">&#39;window height&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_window_width</span> <span class="o">=</span> <span class="n">float_positive</span><span class="p">(</span><span class="n">window_width</span><span class="p">,</span> <span class="s1">&#39;window width&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sill_height</span> <span class="o">=</span> <span class="n">float_positive</span><span class="p">(</span><span class="n">sill_height</span><span class="p">,</span> <span class="s1">&#39;sill height&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_horizontal_separation</span> <span class="o">=</span> \
            <span class="n">float_positive</span><span class="p">(</span><span class="n">horizontal_separation</span><span class="p">,</span> <span class="s1">&#39;window horizontal separation&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">window_height</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a number or the target height of the windows.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_window_height</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">window_width</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a number or the target width of the windows.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_window_width</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sill_height</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a number for the height above the bottom edge of the floor.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sill_height</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">horizontal_separation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a number for the separation between individual window center lines.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_horizontal_separation</span>

<div class="viewcode-block" id="RepeatingWindowWidthHeight.area_from_segment"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.RepeatingWindowWidthHeight.area_from_segment">[docs]</a>    <span class="k">def</span> <span class="nf">area_from_segment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">segment</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the window area generated by these parameters from a LineSegment3D.</span>

<span class="sd">        Args:</span>
<span class="sd">            segment: A LineSegment3D to which these parameters are applied.</span>
<span class="sd">            floor_to_ceiling_height: The floor-to-ceiling height of the Room2D</span>
<span class="sd">                to which the segment belongs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">hgt</span> <span class="o">=</span> <span class="n">floor_to_ceiling_height</span> <span class="o">-</span> <span class="mf">0.02</span> <span class="o">*</span> <span class="n">floor_to_ceiling_height</span> <span class="k">if</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">window_height</span> <span class="o">&gt;=</span> <span class="n">floor_to_ceiling_height</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_height</span>
        <span class="n">max_width_break_up</span> <span class="o">=</span> <span class="n">segment</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_width</span> <span class="o">&lt;</span> <span class="n">max_width_break_up</span><span class="p">:</span>  <span class="c1"># multiple windows</span>
            <span class="n">num_div</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">segment</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">horizontal_separation</span><span class="p">)</span> <span class="k">if</span> \
                <span class="n">segment</span><span class="o">.</span><span class="n">length</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">horizontal_separation</span> <span class="o">/</span> <span class="mi">2</span> <span class="k">else</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">num_div</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_width</span> <span class="o">+</span> <span class="p">(</span><span class="n">num_div</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> \
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">horizontal_separation</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_width</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">segment</span><span class="o">.</span><span class="n">length</span><span class="p">:</span>
                <span class="n">num_div</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">segment</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">horizontal_separation</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">num_div</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_width</span> <span class="o">*</span> <span class="n">hgt</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># one single window</span>
            <span class="k">return</span> <span class="n">segment</span><span class="o">.</span><span class="n">length</span> <span class="o">*</span> <span class="mf">0.98</span> <span class="o">*</span> <span class="n">hgt</span></div>

<div class="viewcode-block" id="RepeatingWindowWidthHeight.to_rectangular_windows"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.RepeatingWindowWidthHeight.to_rectangular_windows">[docs]</a>    <span class="k">def</span> <span class="nf">to_rectangular_windows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">segment</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a version of these WindowParameters as RectangularWindows.</span>

<span class="sd">        Args:</span>
<span class="sd">            segment: A LineSegment3D to which these parameters are applied.</span>
<span class="sd">            floor_to_ceiling_height: The floor-to-ceiling height of the Room2D</span>
<span class="sd">                to which the segment belongs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">base_plane</span> <span class="o">=</span> <span class="n">Plane</span><span class="p">(</span><span class="n">segment</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">rotate_xy</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="n">segment</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="n">segment</span><span class="o">.</span><span class="n">v</span><span class="p">)</span>
        <span class="n">sub_rects</span> <span class="o">=</span> <span class="n">Face3D</span><span class="o">.</span><span class="n">sub_rects_from_rect_dimensions</span><span class="p">(</span>
            <span class="n">base_plane</span><span class="p">,</span> <span class="n">segment</span><span class="o">.</span><span class="n">length</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_height</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">window_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sill_height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">horizontal_separation</span>
        <span class="p">)</span>
        <span class="n">origins</span><span class="p">,</span> <span class="n">widths</span><span class="p">,</span> <span class="n">heights</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">rect</span> <span class="ow">in</span> <span class="n">sub_rects</span><span class="p">:</span>
            <span class="n">poly</span> <span class="o">=</span> <span class="n">Polygon2D</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">base_plane</span><span class="o">.</span><span class="n">xyz_to_xy</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">rect</span><span class="p">))</span>
            <span class="n">min_pt</span><span class="p">,</span> <span class="n">max_pt</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">max</span>
            <span class="n">origins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">min_pt</span><span class="p">)</span>
            <span class="n">widths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">max_pt</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">min_pt</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
            <span class="n">heights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">max_pt</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">min_pt</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="n">new_w</span> <span class="o">=</span> <span class="n">RectangularWindows</span><span class="p">(</span><span class="n">origins</span><span class="p">,</span> <span class="n">widths</span><span class="p">,</span> <span class="n">heights</span><span class="p">)</span>
        <span class="n">new_w</span><span class="o">.</span><span class="n">_user_data</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">new_w</span></div>

<div class="viewcode-block" id="RepeatingWindowWidthHeight.add_window_to_face"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.RepeatingWindowWidthHeight.add_window_to_face">[docs]</a>    <span class="k">def</span> <span class="nf">add_window_to_face</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">face</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add Apertures to a Honeybee Face using these Window Parameters.</span>

<span class="sd">        Args:</span>
<span class="sd">            face: A honeybee-core Face object.</span>
<span class="sd">            tolerance: The maximum difference between point values for them to be</span>
<span class="sd">                considered a part of a rectangle. Default: 0.01, suitable for</span>
<span class="sd">                objects in meters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_window_width</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_window_height</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">face</span><span class="o">.</span><span class="n">apertures_by_width_height_rectangle</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">window_height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sill_height</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">horizontal_separation</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">)</span>
        <span class="c1"># if the Aperture is interior, set adjacent boundary condition</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">face</span><span class="o">.</span><span class="n">_boundary_condition</span><span class="p">,</span> <span class="n">Surface</span><span class="p">):</span>
            <span class="n">num_aps</span> <span class="o">=</span> <span class="n">face</span><span class="o">.</span><span class="n">apertures</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ap</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">face</span><span class="o">.</span><span class="n">apertures</span><span class="p">):</span>
                <span class="n">ids</span> <span class="o">=</span> <span class="n">face</span><span class="o">.</span><span class="n">_boundary_condition</span><span class="o">.</span><span class="n">boundary_condition_objects</span>
                <span class="n">adj_ap_id</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_Glz</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">num_aps</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">final_ids</span> <span class="o">=</span> <span class="p">(</span><span class="n">adj_ap_id</span><span class="p">,)</span> <span class="o">+</span> <span class="n">ids</span>
                <span class="n">ap</span><span class="o">.</span><span class="n">boundary_condition</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">final_ids</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_apply_user_data_to_honeybee</span><span class="p">(</span><span class="n">face</span><span class="o">.</span><span class="n">apertures</span><span class="p">)</span></div>

<div class="viewcode-block" id="RepeatingWindowWidthHeight.scale"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.RepeatingWindowWidthHeight.scale">[docs]</a>    <span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a scaled version of these WindowParameters.</span>

<span class="sd">        This method is called within the scale methods of the Room2D.</span>

<span class="sd">        Args:</span>
<span class="sd">            factor: A number representing how much the object should be scaled.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_w</span> <span class="o">=</span> <span class="n">RepeatingWindowWidthHeight</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">window_height</span> <span class="o">*</span> <span class="n">factor</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_width</span> <span class="o">*</span> <span class="n">factor</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sill_height</span> <span class="o">*</span> <span class="n">factor</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">horizontal_separation</span> <span class="o">*</span> <span class="n">factor</span><span class="p">)</span>
        <span class="n">new_w</span><span class="o">.</span><span class="n">_user_data</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">new_w</span></div>

<div class="viewcode-block" id="RepeatingWindowWidthHeight.split"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.RepeatingWindowWidthHeight.split">[docs]</a>    <span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">segments</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Split RepeatingWindowWidthHeight parameters across a list of ordered segments.</span>

<span class="sd">        Args:</span>
<span class="sd">            segments: The segments to which the window parameters are being</span>
<span class="sd">                split across. These should be in order as they appear on the</span>
<span class="sd">                parent Room2D.</span>
<span class="sd">            tolerance: The minimum distance between a vertex and the edge of the</span>
<span class="sd">                wall segment that is considered not touching. (Default: 0.01, suitable</span>
<span class="sd">                for objects in meters).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># just distribute the windows evenly</span>
        <span class="n">new_w_par</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">segments</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_user_data</span><span class="p">(</span><span class="n">new_w_par</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_w_par</span></div>

<div class="viewcode-block" id="RepeatingWindowWidthHeight.merge"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.RepeatingWindowWidthHeight.merge">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="n">window_parameters</span><span class="p">,</span> <span class="n">segments</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Merge RepeatingWindowWidthHeight parameters using their assigned segments.</span>

<span class="sd">        Args:</span>
<span class="sd">            window_parameters: A list of WindowParameters to be merged.</span>
<span class="sd">            segments: The segments to which the window parameters are assigned.</span>
<span class="sd">                These should be in order as they appear on the parent Room2D.</span>
<span class="sd">            floor_to_ceiling_height: The floor-to-ceiling height of the Room2D</span>
<span class="sd">                to which the segments belong.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">weights</span><span class="p">,</span> <span class="n">heights</span><span class="p">,</span> <span class="n">widths</span><span class="p">,</span> <span class="n">sill_heights</span><span class="p">,</span> <span class="n">h_seps</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">wp</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">window_parameters</span><span class="p">,</span> <span class="n">segments</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">wp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wp</span><span class="p">,</span> <span class="n">RepeatingWindowWidthHeight</span><span class="p">):</span>
                    <span class="n">weights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">length</span><span class="p">)</span>
                    <span class="n">heights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wp</span><span class="o">.</span><span class="n">window_height</span><span class="p">)</span>
                    <span class="n">widths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wp</span><span class="o">.</span><span class="n">window_width</span><span class="p">)</span>
                    <span class="n">sill_heights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wp</span><span class="o">.</span><span class="n">sill_height</span><span class="p">)</span>
                    <span class="n">h_seps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wp</span><span class="o">.</span><span class="n">horizontal_separation</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># not all windows are of the same type; convert all to rectangular</span>
                    <span class="k">return</span> <span class="n">_WindowParameterBase</span><span class="o">.</span><span class="n">merge_to_rectangular</span><span class="p">(</span>
                        <span class="n">window_parameters</span><span class="p">,</span> <span class="n">segments</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">)</span>
        <span class="n">tw</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span> <span class="o">/</span> <span class="n">tw</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">weights</span><span class="p">]</span>
        <span class="n">height</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">h</span> <span class="o">*</span> <span class="n">w</span> <span class="k">for</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">heights</span><span class="p">,</span> <span class="n">weights</span><span class="p">)])</span>
        <span class="n">width</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">x</span> <span class="o">*</span> <span class="n">w</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">widths</span><span class="p">,</span> <span class="n">weights</span><span class="p">)])</span>
        <span class="n">sill_height</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">h</span> <span class="o">*</span> <span class="n">w</span> <span class="k">for</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sill_heights</span><span class="p">,</span> <span class="n">weights</span><span class="p">)])</span>
        <span class="n">h_sep</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">s</span> <span class="o">*</span> <span class="n">w</span> <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">h_seps</span><span class="p">,</span> <span class="n">weights</span><span class="p">)])</span>
        <span class="n">new_w</span> <span class="o">=</span> <span class="n">RepeatingWindowWidthHeight</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">sill_height</span><span class="p">,</span> <span class="n">h_sep</span><span class="p">)</span>
        <span class="n">new_w</span><span class="o">.</span><span class="n">_user_data</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">window_parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> \
            <span class="n">window_parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">user_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">new_w</span></div>

<div class="viewcode-block" id="RepeatingWindowWidthHeight.from_dict"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.RepeatingWindowWidthHeight.from_dict">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create RepeatingWindowWidthHeight from a dictionary.</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            {</span>
<span class="sd">            &quot;type&quot;: &quot;RepeatingWindowWidthHeight&quot;,</span>
<span class="sd">            &quot;window_height&quot;: 2,</span>
<span class="sd">            &quot;window_width&quot;: 1.5,</span>
<span class="sd">            &quot;sill_height&quot;: 0.8,</span>
<span class="sd">            &quot;horizontal_separation&quot;: 4</span>
<span class="sd">            }</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;RepeatingWindowWidthHeight&#39;</span><span class="p">,</span> <span class="s1">&#39;Expected &#39;</span> \
            <span class="s1">&#39;RepeatingWindowWidthHeight dictionary. Got </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">])</span>
        <span class="n">new_w_par</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;window_height&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;window_width&#39;</span><span class="p">],</span>
                        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;sill_height&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;horizontal_separation&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s1">&#39;user_data&#39;</span> <span class="ow">in</span> <span class="n">data</span> <span class="ow">and</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;user_data&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">new_w_par</span><span class="o">.</span><span class="n">user_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;user_data&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">new_w_par</span></div>

<div class="viewcode-block" id="RepeatingWindowWidthHeight.to_dict"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.RepeatingWindowWidthHeight.to_dict">[docs]</a>    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get RepeatingWindowWidthHeight as a dictionary.&quot;&quot;&quot;</span>
        <span class="n">base</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;RepeatingWindowWidthHeight&#39;</span><span class="p">,</span>
            <span class="s1">&#39;window_height&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_height</span><span class="p">,</span>
            <span class="s1">&#39;window_width&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_width</span><span class="p">,</span>
            <span class="s1">&#39;sill_height&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sill_height</span><span class="p">,</span>
            <span class="s1">&#39;horizontal_separation&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">horizontal_separation</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">base</span><span class="p">[</span><span class="s1">&#39;user_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span>
        <span class="k">return</span> <span class="n">base</span></div>

    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">new_w</span> <span class="o">=</span> <span class="n">RepeatingWindowWidthHeight</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_window_height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_window_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sill_height</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_horizontal_separation</span><span class="p">)</span>
        <span class="n">new_w</span><span class="o">.</span><span class="n">_user_data</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">new_w</span>

    <span class="k">def</span> <span class="nf">__key</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A tuple based on the object properties, useful for hashing.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_window_height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_window_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sill_height</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_horizontal_separation</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__key</span><span class="p">())</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">RepeatingWindowWidthHeight</span><span class="p">)</span> <span class="ow">and</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">__key</span><span class="p">()</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">__key</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;RepeatingWindowWidthHeight: [window_height: </span><span class="si">{}</span><span class="s1">] [window_width: &#39;</span> \
            <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">] [sill_height: </span><span class="si">{}</span><span class="s1">] [horizontal: </span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">window_height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sill_height</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">horizontal_separation</span><span class="p">)</span></div>


<span class="k">class</span> <span class="nc">_AsymmetricBase</span><span class="p">(</span><span class="n">_WindowParameterBase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for WindowParameters that can make asymmetric windows on a wall.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">flip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seg_length</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Flip the direction of the windows along a wall segment.</span>

<span class="sd">        This is needed since windows can exist asymmetrically across the wall</span>
<span class="sd">        segment and operations like reflecting the Room2D across a plane will</span>
<span class="sd">        require the window parameters to be flipped. Reversing the Room2D vertices</span>
<span class="sd">        also requires flipping.</span>

<span class="sd">        Args:</span>
<span class="sd">            seg_length: The length of the segment along which the parameters are</span>
<span class="sd">                being flipped.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">_merge_user_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">original_w_par</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Build this object&#39;s user_data from those of merged window parameters.</span>

<span class="sd">        Args:</span>
<span class="sd">            original_w_par: An array of the original window parameters used to</span>
<span class="sd">                build this one.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">ow_par</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">ow_par</span> <span class="ow">in</span> <span class="n">original_w_par</span><span class="p">):</span>
            <span class="n">new_u</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">ow_par</span> <span class="ow">in</span> <span class="n">original_w_par</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ow_par</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">ow_par</span><span class="o">.</span><span class="n">user_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">new_u</span><span class="p">:</span>
                            <span class="n">new_u</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
                        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_u</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="ow">and</span> \
                                <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="ow">and</span> \
                                <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ow_par</span><span class="p">):</span>
                            <span class="n">new_u</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_u</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">+</span> <span class="n">val</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="o">=</span> <span class="n">new_u</span>

    <span class="k">def</span> <span class="nf">_split_user_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">split_win_par</span><span class="p">,</span> <span class="n">win_par_indices</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Assign user_data to split WindowParameters with the help of split indices.</span>

<span class="sd">        Args:</span>
<span class="sd">            split_win_par: An array of WindowParameters that were derived by</span>
<span class="sd">                splitting this one.</span>
<span class="sd">            win_par_indices: A list of lists where each sub-list represents one of</span>
<span class="sd">                the WindowParameters in the split_win_par ean each item of each</span>
<span class="sd">                sub-list represents one of the rectangles or polygons in the</span>
<span class="sd">                window parameters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">win_par</span><span class="p">,</span> <span class="n">wp_i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">split_win_par</span><span class="p">,</span> <span class="n">win_par_indices</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">win_par</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">u_dict</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                        <span class="n">u_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">wp_i</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">u_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
                <span class="n">win_par</span><span class="o">.</span><span class="n">user_data</span> <span class="o">=</span> <span class="n">u_dict</span>


<div class="viewcode-block" id="RectangularWindows"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.RectangularWindows">[docs]</a><span class="k">class</span> <span class="nc">RectangularWindows</span><span class="p">(</span><span class="n">_AsymmetricBase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Instructions for several rectangular windows, defined by origin, width and height.</span>

<span class="sd">    Note that, if these parameters are applied to a base wall that is too short</span>
<span class="sd">    or too narrow such that the windows fall outside the boundary of the wall, the</span>
<span class="sd">    generated windows will automatically be shortened or excluded. This way, a</span>
<span class="sd">    certain pattern of repeating rectangular windows can be encoded in a single</span>
<span class="sd">    RectangularWindows instance and applied to multiple Room2D segments.</span>

<span class="sd">    Args:</span>
<span class="sd">        origins: An array of ladybug_geometry Point2D objects within the plane</span>
<span class="sd">            of the wall for the origin of each window. The wall plane is assumed</span>
<span class="sd">            to have an origin at the first point of the wall segment and an</span>
<span class="sd">            X-axis extending along the length of the segment. The wall plane&#39;s</span>
<span class="sd">            Y-axis always points upwards.  Therefore, both X and Y values of</span>
<span class="sd">            each origin point should be positive.</span>
<span class="sd">        widths: An array of positive numbers for the window widths. The length</span>
<span class="sd">            of this list must match the length of the origins.</span>
<span class="sd">        heights: An array of positive numbers for the window heights. The length</span>
<span class="sd">            of this list must match the length of the origins.</span>
<span class="sd">        are_doors: An array of booleans that align with the origins and note whether</span>
<span class="sd">            each of the geometries represents a door (True) or a window (False).</span>
<span class="sd">            If None, it will be assumed that all geometries represent windows and</span>
<span class="sd">            they will be translated to Apertures in any resulting Honeybee</span>
<span class="sd">            model. (Default: None).</span>

<span class="sd">    Properties:</span>
<span class="sd">        * origins</span>
<span class="sd">        * widths</span>
<span class="sd">        * heights</span>
<span class="sd">        * are_doors</span>
<span class="sd">        * user_data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_origins&#39;</span><span class="p">,</span> <span class="s1">&#39;_widths&#39;</span><span class="p">,</span> <span class="s1">&#39;_heights&#39;</span><span class="p">,</span> <span class="s1">&#39;_are_doors&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">origins</span><span class="p">,</span> <span class="n">widths</span><span class="p">,</span> <span class="n">heights</span><span class="p">,</span> <span class="n">are_doors</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize RectangularWindows.&quot;&quot;&quot;</span>
        <span class="n">_WindowParameterBase</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="c1"># add the user_data</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">origins</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">origins</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">origins</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">origins</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">Point2D</span><span class="p">),</span> \
                <span class="s1">&#39;Expected Point2D for window origin. Got </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">point</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_origins</span> <span class="o">=</span> <span class="n">origins</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_widths</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">float_positive</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="s1">&#39;window width&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">width</span> <span class="ow">in</span> <span class="n">widths</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_heights</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">float_positive</span><span class="p">(</span><span class="n">hgt</span><span class="p">,</span> <span class="s1">&#39;window height&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">hgt</span> <span class="ow">in</span> <span class="n">heights</span><span class="p">)</span>

        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_origins</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_widths</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_heights</span><span class="p">),</span> \
            <span class="s1">&#39;Number of window origins, widths, and heights must match.&#39;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_origins</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span> \
            <span class="s1">&#39;There must be at least one window to use RectangularWindows.&#39;</span>

        <span class="k">if</span> <span class="n">are_doors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_are_doors</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">origins</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">are_doors</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">are_doors</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">are_doors</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">is_dr</span> <span class="ow">in</span> <span class="n">are_doors</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">is_dr</span><span class="p">,</span> <span class="nb">bool</span><span class="p">),</span> <span class="s1">&#39;Expected booleans for &#39;</span> \
                    <span class="s1">&#39;RectangularWindows.are_doors. Got </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">is_dr</span><span class="p">))</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">are_doors</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">origins</span><span class="p">),</span> \
                <span class="s1">&#39;Length of RectangularWindows.are_doors (</span><span class="si">{}</span><span class="s1">) does not match length &#39;</span> \
                <span class="s1">&#39;of RectangularWindows.origins (</span><span class="si">{}</span><span class="s1">).&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="nb">len</span><span class="p">(</span><span class="n">are_doors</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">origins</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_are_doors</span> <span class="o">=</span> <span class="n">are_doors</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">origins</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get an array of Point2Ds within the wall plane for the origin of each window.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_origins</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">widths</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get an array of numbers for the window widths.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_widths</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">heights</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get an array of numbers for the window heights.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_heights</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">are_doors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get an array of booleans that note whether each geometry is a door.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_are_doors</span>

<div class="viewcode-block" id="RectangularWindows.area_from_segment"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.RectangularWindows.area_from_segment">[docs]</a>    <span class="k">def</span> <span class="nf">area_from_segment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">segment</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the window area generated by these parameters from a LineSegment3D.</span>

<span class="sd">        Args:</span>
<span class="sd">            segment: A LineSegment3D to which these parameters are applied.</span>
<span class="sd">            floor_to_ceiling_height: The floor-to-ceiling height of the Room2D</span>
<span class="sd">                to which the segment belongs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">max_width</span> <span class="o">=</span> <span class="n">segment</span><span class="o">.</span><span class="n">length</span> <span class="o">*</span> <span class="mf">0.999</span>
        <span class="n">max_height</span> <span class="o">=</span> <span class="n">floor_to_ceiling_height</span> <span class="o">*</span> <span class="mf">0.999</span>

        <span class="n">areas</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">o</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">origins</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">widths</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">heights</span><span class="p">):</span>
            <span class="n">final_width</span> <span class="o">=</span> <span class="n">max_width</span> <span class="o">-</span> <span class="n">o</span><span class="o">.</span><span class="n">x</span> <span class="k">if</span> <span class="n">width</span> <span class="o">+</span> <span class="n">o</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">max_width</span> <span class="k">else</span> <span class="n">width</span>
            <span class="n">final_height</span> <span class="o">=</span> <span class="n">max_height</span> <span class="o">-</span> <span class="n">o</span><span class="o">.</span><span class="n">y</span> <span class="k">if</span> <span class="n">height</span> <span class="o">+</span> <span class="n">o</span><span class="o">.</span><span class="n">y</span> <span class="o">&gt;</span> <span class="n">max_height</span> <span class="k">else</span> <span class="n">height</span>
            <span class="k">if</span> <span class="n">final_height</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">final_height</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># inside wall boundary</span>
                <span class="n">areas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">final_width</span> <span class="o">*</span> <span class="n">final_height</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">areas</span><span class="p">)</span></div>

<div class="viewcode-block" id="RectangularWindows.check_valid_for_segment"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.RectangularWindows.check_valid_for_segment">[docs]</a>    <span class="k">def</span> <span class="nf">check_valid_for_segment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">segment</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check that these window parameters are valid for a given LineSegment3D.</span>

<span class="sd">        Args:</span>
<span class="sd">            segment: A LineSegment3D to which these parameters are applied.</span>
<span class="sd">            floor_to_ceiling_height: The floor-to-ceiling height of the Room2D</span>
<span class="sd">                to which the segment belongs.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A string with the message. Will be an empty string if valid.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">total_area</span> <span class="o">=</span> <span class="n">segment</span><span class="o">.</span><span class="n">length</span> <span class="o">*</span> <span class="n">floor_to_ceiling_height</span>
        <span class="n">win_area</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">area_from_segment</span><span class="p">(</span><span class="n">segment</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">win_area</span> <span class="o">&gt;=</span> <span class="n">total_area</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;Total area of windows [</span><span class="si">{}</span><span class="s1">] is greater than the area of the &#39;</span> \
                <span class="s1">&#39;parent wall [</span><span class="si">{}</span><span class="s1">].&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">win_area</span><span class="p">,</span> <span class="n">total_area</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span></div>

<div class="viewcode-block" id="RectangularWindows.to_rectangular_windows"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.RectangularWindows.to_rectangular_windows">[docs]</a>    <span class="k">def</span> <span class="nf">to_rectangular_windows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">segment</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a version of these WindowParameters as RectangularWindows.</span>

<span class="sd">        Args:</span>
<span class="sd">            segment: A LineSegment3D to which these parameters are applied.</span>
<span class="sd">            floor_to_ceiling_height: The floor-to-ceiling height of the Room2D</span>
<span class="sd">                to which the segment belongs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="RectangularWindows.add_window_to_face"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.RectangularWindows.add_window_to_face">[docs]</a>    <span class="k">def</span> <span class="nf">add_window_to_face</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">face</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add Apertures to a Honeybee Face using these Window Parameters.</span>

<span class="sd">        Args:</span>
<span class="sd">            face: A honeybee-core Face object.</span>
<span class="sd">            tolerance: Optional tolerance value. Default: 0.01, suitable for</span>
<span class="sd">                objects in meters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># collect the global properties of the face that set limits on apertures</span>
        <span class="n">wall_plane</span> <span class="o">=</span> <span class="n">face</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">plane</span>
        <span class="n">wall_plane</span> <span class="o">=</span> <span class="n">wall_plane</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">wall_plane</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">wall_plane</span><span class="o">.</span><span class="n">o</span><span class="p">)</span>
        <span class="n">width_seg</span> <span class="o">=</span> <span class="n">LineSegment3D</span><span class="o">.</span><span class="n">from_end_points</span><span class="p">(</span><span class="n">face</span><span class="o">.</span><span class="n">geometry</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">face</span><span class="o">.</span><span class="n">geometry</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">h_vec</span><span class="p">,</span> <span class="n">b_pt</span> <span class="o">=</span> <span class="n">Vector3D</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">face</span><span class="o">.</span><span class="n">max</span><span class="o">.</span><span class="n">z</span> <span class="o">-</span> <span class="n">face</span><span class="o">.</span><span class="n">min</span><span class="o">.</span><span class="n">z</span><span class="p">),</span> <span class="n">face</span><span class="o">.</span><span class="n">geometry</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">height_seg</span> <span class="o">=</span> <span class="n">LineSegment3D</span><span class="o">.</span><span class="n">from_end_points</span><span class="p">(</span><span class="n">b_pt</span><span class="p">,</span> <span class="n">b_pt</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">h_vec</span><span class="p">))</span>
        <span class="n">max_width</span> <span class="o">=</span> <span class="n">width_seg</span><span class="o">.</span><span class="n">length</span> <span class="o">*</span> <span class="mf">0.99</span>
        <span class="n">max_height</span> <span class="o">=</span> <span class="n">height_seg</span><span class="o">.</span><span class="n">length</span> <span class="o">*</span> <span class="mf">0.99</span>

        <span class="c1"># loop through each window and create its geometry</span>
        <span class="n">sub_faces</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">zip_obj</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">origins</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">widths</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">heights</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">are_doors</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">wid</span><span class="p">,</span> <span class="n">hgt</span><span class="p">,</span> <span class="n">isd</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">zip_obj</span><span class="p">):</span>
            <span class="n">final_width</span> <span class="o">=</span> <span class="n">max_width</span> <span class="o">-</span> <span class="n">o</span><span class="o">.</span><span class="n">x</span> <span class="k">if</span> <span class="n">wid</span> <span class="o">+</span> <span class="n">o</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">max_width</span> <span class="k">else</span> <span class="n">wid</span>
            <span class="n">final_height</span> <span class="o">=</span> <span class="n">max_height</span> <span class="o">-</span> <span class="n">o</span><span class="o">.</span><span class="n">y</span> <span class="k">if</span> <span class="n">hgt</span> <span class="o">+</span> <span class="n">o</span><span class="o">.</span><span class="n">y</span> <span class="o">&gt;</span> <span class="n">max_height</span> <span class="k">else</span> <span class="n">hgt</span>
            <span class="k">if</span> <span class="n">final_height</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">final_height</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># inside wall boundary</span>
                <span class="n">base_plane</span> <span class="o">=</span> <span class="n">Plane</span><span class="p">(</span><span class="n">wall_plane</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="n">wall_plane</span><span class="o">.</span><span class="n">xy_to_xyz</span><span class="p">(</span><span class="n">o</span><span class="p">),</span> <span class="n">wall_plane</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
                <span class="n">s_geo</span> <span class="o">=</span> <span class="n">Face3D</span><span class="o">.</span><span class="n">from_rectangle</span><span class="p">(</span><span class="n">final_width</span><span class="p">,</span> <span class="n">final_height</span><span class="p">,</span> <span class="n">base_plane</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">isd</span><span class="p">:</span>
                    <span class="n">sub_f</span> <span class="o">=</span> <span class="n">Door</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_Door</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">face</span><span class="o">.</span><span class="n">identifier</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">s_geo</span><span class="p">)</span>
                    <span class="n">face</span><span class="o">.</span><span class="n">add_door</span><span class="p">(</span><span class="n">sub_f</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">sub_f</span> <span class="o">=</span> <span class="n">Aperture</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_Glz</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">face</span><span class="o">.</span><span class="n">identifier</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">s_geo</span><span class="p">)</span>
                    <span class="n">face</span><span class="o">.</span><span class="n">add_aperture</span><span class="p">(</span><span class="n">sub_f</span><span class="p">)</span>
                <span class="n">sub_faces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sub_f</span><span class="p">)</span>
                <span class="c1"># if the Aperture is interior, set adjacent boundary condition</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">face</span><span class="o">.</span><span class="n">_boundary_condition</span><span class="p">,</span> <span class="n">Surface</span><span class="p">):</span>
                    <span class="n">ids</span> <span class="o">=</span> <span class="n">face</span><span class="o">.</span><span class="n">_boundary_condition</span><span class="o">.</span><span class="n">boundary_condition_objects</span>
                    <span class="n">sf_type</span> <span class="o">=</span> <span class="s1">&#39;Door&#39;</span> <span class="k">if</span> <span class="n">isd</span> <span class="k">else</span> <span class="s1">&#39;Glz&#39;</span>
                    <span class="n">adj_sf_id</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sf_type</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="n">final_ids</span> <span class="o">=</span> <span class="p">(</span><span class="n">adj_sf_id</span><span class="p">,)</span> <span class="o">+</span> <span class="n">ids</span>
                    <span class="n">sub_f</span><span class="o">.</span><span class="n">boundary_condition</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">final_ids</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_apply_user_data_to_honeybee</span><span class="p">(</span><span class="n">sub_faces</span><span class="p">)</span></div>

<div class="viewcode-block" id="RectangularWindows.scale"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.RectangularWindows.scale">[docs]</a>    <span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a scaled version of these WindowParameters.</span>

<span class="sd">        This method is called within the scale methods of the Room2D.</span>

<span class="sd">        Args:</span>
<span class="sd">            factor: A number representing how much the object should be scaled.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_w</span> <span class="o">=</span> <span class="n">RectangularWindows</span><span class="p">(</span>
            <span class="nb">tuple</span><span class="p">(</span><span class="n">Point2D</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">factor</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">factor</span><span class="p">)</span> <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">origins</span><span class="p">),</span>
            <span class="nb">tuple</span><span class="p">(</span><span class="n">width</span> <span class="o">*</span> <span class="n">factor</span> <span class="k">for</span> <span class="n">width</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">widths</span><span class="p">),</span>
            <span class="nb">tuple</span><span class="p">(</span><span class="n">height</span> <span class="o">*</span> <span class="n">factor</span> <span class="k">for</span> <span class="n">height</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">heights</span><span class="p">),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">are_doors</span><span class="p">)</span>
        <span class="n">new_w</span><span class="o">.</span><span class="n">_user_data</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">new_w</span></div>

<div class="viewcode-block" id="RectangularWindows.flip"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.RectangularWindows.flip">[docs]</a>    <span class="k">def</span> <span class="nf">flip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seg_length</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Flip the direction of the windows along a segment.</span>

<span class="sd">        This is needed since windows can exist asymmetrically across the wall</span>
<span class="sd">        segment and operations like reflecting the Room2D across a plane will</span>
<span class="sd">        require the window parameters to be flipped to remain in the same place.</span>

<span class="sd">        Args:</span>
<span class="sd">            seg_length: The length of the segment along which the parameters are</span>
<span class="sd">                being flipped.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_origins</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">new_widths</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">new_heights</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">new_are_doors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">zip_obj</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">origins</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">widths</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">heights</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">are_doors</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">o</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">is_dr</span> <span class="ow">in</span> <span class="n">zip_obj</span><span class="p">:</span>
            <span class="n">new_x</span> <span class="o">=</span> <span class="n">seg_length</span> <span class="o">-</span> <span class="n">o</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">width</span>
            <span class="k">if</span> <span class="n">new_x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># fully within the wall boundary</span>
                <span class="n">new_origins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Point2D</span><span class="p">(</span><span class="n">new_x</span><span class="p">,</span> <span class="n">o</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
                <span class="n">new_widths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">width</span><span class="p">)</span>
                <span class="n">new_heights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">height</span><span class="p">)</span>
                <span class="n">new_are_doors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">is_dr</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">new_x</span> <span class="o">+</span> <span class="n">width</span> <span class="o">&gt;</span> <span class="n">seg_length</span> <span class="o">*</span> <span class="mf">0.001</span><span class="p">:</span>  <span class="c1"># partially within the boundary</span>
                <span class="n">new_widths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">width</span> <span class="o">+</span> <span class="n">new_x</span> <span class="o">-</span> <span class="p">(</span><span class="n">seg_length</span> <span class="o">*</span> <span class="mf">0.001</span><span class="p">))</span>
                <span class="n">new_x</span> <span class="o">=</span> <span class="n">seg_length</span> <span class="o">*</span> <span class="mf">0.001</span>
                <span class="n">new_origins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Point2D</span><span class="p">(</span><span class="n">new_x</span><span class="p">,</span> <span class="n">o</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
                <span class="n">new_heights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">height</span><span class="p">)</span>
                <span class="n">new_are_doors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">is_dr</span><span class="p">)</span>
        <span class="n">new_w</span> <span class="o">=</span> <span class="n">RectangularWindows</span><span class="p">(</span><span class="n">new_origins</span><span class="p">,</span> <span class="n">new_widths</span><span class="p">,</span> <span class="n">new_heights</span><span class="p">,</span> <span class="n">new_are_doors</span><span class="p">)</span>
        <span class="n">new_w</span><span class="o">.</span><span class="n">_user_data</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">new_w</span></div>

<div class="viewcode-block" id="RectangularWindows.split"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.RectangularWindows.split">[docs]</a>    <span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">segments</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Split RectangularWindows parameters across a list of ordered segments.</span>

<span class="sd">        Args:</span>
<span class="sd">            segments: The segments to which the window parameters are being</span>
<span class="sd">                split across. These should be in order as they appear on the</span>
<span class="sd">                parent Room2D.</span>
<span class="sd">            tolerance: The minimum distance between a vertex and the edge of the</span>
<span class="sd">                wall segment that is considered not touching. (Default: 0.01, suitable</span>
<span class="sd">                for objects in meters).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_win_pars</span><span class="p">,</span> <span class="n">win_par_is</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="n">rel_pt</span><span class="p">,</span> <span class="n">rel_w</span><span class="p">,</span> <span class="n">rel_h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">origins</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">widths</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">heights</span>
        <span class="n">rel_d</span><span class="p">,</span> <span class="n">rel_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">are_doors</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">origins</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="n">segments</span><span class="p">:</span>
            <span class="c1"># loop through the vertices and adjust them to the max width</span>
            <span class="n">win_par_i</span><span class="p">,</span> <span class="n">out_i</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
            <span class="n">seg_len</span> <span class="o">=</span> <span class="n">segment</span><span class="o">.</span><span class="n">length</span>
            <span class="n">max_width</span> <span class="o">=</span> <span class="n">seg_len</span> <span class="o">-</span> <span class="n">tolerance</span>
            <span class="n">new_pts</span><span class="p">,</span> <span class="n">new_w</span><span class="p">,</span> <span class="n">new_h</span><span class="p">,</span> <span class="n">new_d</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
            <span class="n">out_pts</span><span class="p">,</span> <span class="n">out_w</span><span class="p">,</span> <span class="n">out_h</span><span class="p">,</span> <span class="n">out_d</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">pt</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">rel_pt</span><span class="p">,</span> <span class="n">rel_w</span><span class="p">,</span> <span class="n">rel_h</span><span class="p">,</span> <span class="n">rel_d</span><span class="p">,</span> <span class="n">rel_i</span><span class="p">):</span>
                <span class="n">x_val</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">x</span>
                <span class="k">if</span> <span class="n">x_val</span> <span class="o">&gt;=</span> <span class="n">max_width</span><span class="p">:</span>  <span class="c1"># completely outside of the segment</span>
                    <span class="n">out_pts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Point2D</span><span class="p">(</span><span class="n">x_val</span> <span class="o">-</span> <span class="n">seg_len</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
                    <span class="n">out_w</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
                    <span class="n">out_h</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
                    <span class="n">out_d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
                    <span class="n">out_i</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">x_val</span> <span class="o">+</span> <span class="n">w</span> <span class="o">&gt;=</span> <span class="n">max_width</span><span class="p">:</span>  <span class="c1"># split by segment</span>
                    <span class="n">split_dist</span> <span class="o">=</span> <span class="n">max_width</span> <span class="o">-</span> <span class="n">x_val</span>
                    <span class="n">new_pts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Point2D</span><span class="p">(</span><span class="n">x_val</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
                    <span class="n">new_w</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">split_dist</span> <span class="o">-</span> <span class="n">tolerance</span><span class="p">)</span>
                    <span class="n">new_h</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
                    <span class="n">new_d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
                    <span class="n">win_par_i</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                    <span class="n">out_pts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Point2D</span><span class="p">(</span><span class="n">tolerance</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
                    <span class="n">out_w</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">w</span> <span class="o">-</span> <span class="n">split_dist</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">tolerance</span><span class="p">))</span>
                    <span class="n">out_h</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
                    <span class="n">out_d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
                    <span class="n">out_i</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># completely inside segment</span>
                    <span class="n">new_pts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span>
                    <span class="n">new_w</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
                    <span class="n">new_h</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
                    <span class="n">new_d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
                    <span class="n">win_par_i</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

            <span class="c1"># build the final window parameters from the adjusted windows</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_pts</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">new_win_pars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RectangularWindows</span><span class="p">(</span><span class="n">new_pts</span><span class="p">,</span> <span class="n">new_w</span><span class="p">,</span> <span class="n">new_h</span><span class="p">,</span> <span class="n">new_d</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_win_pars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="n">win_par_is</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">win_par_i</span><span class="p">)</span>
            <span class="c1"># shift all windows to be relevant for the next segment</span>
            <span class="n">rel_pt</span><span class="p">,</span> <span class="n">rel_w</span><span class="p">,</span> <span class="n">rel_h</span><span class="p">,</span> <span class="n">rel_d</span><span class="p">,</span> <span class="n">rel_i</span> <span class="o">=</span> <span class="n">out_pts</span><span class="p">,</span> <span class="n">out_w</span><span class="p">,</span> <span class="n">out_h</span><span class="p">,</span> <span class="n">out_d</span><span class="p">,</span> <span class="n">out_i</span>

        <span class="c1"># apply the user_data to the split window parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_split_user_data</span><span class="p">(</span><span class="n">new_win_pars</span><span class="p">,</span> <span class="n">win_par_is</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_win_pars</span></div>

<div class="viewcode-block" id="RectangularWindows.merge"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.RectangularWindows.merge">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="n">window_parameters</span><span class="p">,</span> <span class="n">segments</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Merge RectangularWindows parameters together using their assigned segments.</span>

<span class="sd">        Args:</span>
<span class="sd">            window_parameters: A list of WindowParameters to be merged.</span>
<span class="sd">            segments: The segments to which the window parameters are assigned.</span>
<span class="sd">                These should be in order as they appear on the parent Room2D.</span>
<span class="sd">            floor_to_ceiling_height: The floor-to-ceiling height of the Room2D</span>
<span class="sd">                to which the segments belong.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_w_par</span> <span class="o">=</span> <span class="n">_WindowParameterBase</span><span class="o">.</span><span class="n">merge_to_rectangular</span><span class="p">(</span>
            <span class="n">window_parameters</span><span class="p">,</span> <span class="n">segments</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">)</span>
        <span class="n">new_w_par</span><span class="o">.</span><span class="n">_merge_user_data</span><span class="p">(</span><span class="n">window_parameters</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_w_par</span></div>

<div class="viewcode-block" id="RectangularWindows.from_dict"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.RectangularWindows.from_dict">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create RectangularWindows from a dictionary.</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            {</span>
<span class="sd">            &quot;type&quot;: &quot;RectangularWindows&quot;,</span>
<span class="sd">            &quot;origins&quot;: [(1, 1), (3, 0.5)],  # array of (x, y) floats in wall plane</span>
<span class="sd">            &quot;widths&quot;: [1, 3],  # array of floats for window widths</span>
<span class="sd">            &quot;heights&quot;: [1, 2.5],  # array of floats for window heights</span>
<span class="sd">            &quot;are_doors&quot;: [False, True]  # array of booleans for whether it&#39;s a door</span>
<span class="sd">            }</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;RectangularWindows&#39;</span><span class="p">,</span> \
            <span class="s1">&#39;Expected RectangularWindows. Got </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">])</span>
        <span class="n">are_doors</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;are_doors&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;are_doors&#39;</span> <span class="ow">in</span> <span class="n">data</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">new_w_par</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">Point2D</span><span class="o">.</span><span class="n">from_array</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;origins&#39;</span><span class="p">]),</span>
                        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;widths&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;heights&#39;</span><span class="p">],</span> <span class="n">are_doors</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;user_data&#39;</span> <span class="ow">in</span> <span class="n">data</span> <span class="ow">and</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;user_data&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">new_w_par</span><span class="o">.</span><span class="n">user_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;user_data&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">new_w_par</span></div>

<div class="viewcode-block" id="RectangularWindows.to_dict"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.RectangularWindows.to_dict">[docs]</a>    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get RectangularWindows as a dictionary.&quot;&quot;&quot;</span>
        <span class="n">base</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;RectangularWindows&#39;</span><span class="p">,</span>
            <span class="s1">&#39;origins&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">pt</span><span class="o">.</span><span class="n">to_array</span><span class="p">()</span> <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">origins</span><span class="p">],</span>
            <span class="s1">&#39;widths&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">widths</span><span class="p">,</span>
            <span class="s1">&#39;heights&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">heights</span><span class="p">,</span>
            <span class="s2">&quot;are_doors&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">are_doors</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">base</span><span class="p">[</span><span class="s1">&#39;user_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span>
        <span class="k">return</span> <span class="n">base</span></div>

    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">new_w</span> <span class="o">=</span> <span class="n">RectangularWindows</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">origins</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">widths</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">heights</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">are_doors</span><span class="p">)</span>
        <span class="n">new_w</span><span class="o">.</span><span class="n">_user_data</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">new_w</span>

    <span class="k">def</span> <span class="nf">__key</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A tuple based on the object properties, useful for hashing.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">origins</span><span class="p">),</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widths</span><span class="p">),</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">heights</span><span class="p">),</span>
                <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">are_doors</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__key</span><span class="p">())</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">RectangularWindows</span><span class="p">)</span> <span class="ow">and</span> \
            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_origins</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">_origins</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">origins</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;RectangularWindows: [</span><span class="si">{}</span><span class="s1"> windows]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">origins</span><span class="p">))</span></div>


<div class="viewcode-block" id="DetailedWindows"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.DetailedWindows">[docs]</a><span class="k">class</span> <span class="nc">DetailedWindows</span><span class="p">(</span><span class="n">_AsymmetricBase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Instructions for detailed windows, defined by 2D Polygons (lists of 2D vertices).</span>

<span class="sd">    Note that these parameters are intended to represent windows that are specific</span>
<span class="sd">    to a particular segment and, unlike the other WindowParameters, this class</span>
<span class="sd">    performs no automatic checks to ensure that the windows lie within the</span>
<span class="sd">    boundary of the wall they have been assigned to.</span>

<span class="sd">    Args:</span>
<span class="sd">        polygons: An array of ladybug_geometry Polygon2D objects within the plane</span>
<span class="sd">            of the wall with one polygon for each window. The wall plane is</span>
<span class="sd">            assumed to have an origin at the first point of the wall segment</span>
<span class="sd">            and an X-axis extending along the length of the segment. The wall</span>
<span class="sd">            plane&#39;s Y-axis always points upwards.  Therefore, both X and Y</span>
<span class="sd">            values of each point in the polygon should always be positive.</span>
<span class="sd">        are_doors: An array of booleans that align with the polygons and note</span>
<span class="sd">            whether each of the polygons represents a door (True) or a window (False).</span>
<span class="sd">            If None, it will be assumed that all polygons represent windows and</span>
<span class="sd">            they will be translated to Apertures in any resulting Honeybee</span>
<span class="sd">            model. (Default: None).</span>

<span class="sd">    Properties:</span>
<span class="sd">        * polygons</span>
<span class="sd">        * are_doors</span>
<span class="sd">        * user_data</span>

<span class="sd">    Usage:</span>
<span class="sd">        Note that, if you are starting from 3D vertices of windows, you can</span>
<span class="sd">        use this class to represent them. The DetailedWindows.from_face3ds is the</span>
<span class="sd">        simplest way to do this. Otherwise, below is some sample code to convert</span>
<span class="sd">        from vertices in the same 3D space as a vertical wall to vertices in the 2D</span>
<span class="sd">        plane of the wall (as this class interprets it).</span>

<span class="sd">        In the code, &#39;seg_p1&#39; is the first point of a given wall segment and</span>
<span class="sd">        is assumed to be the origin of the wall plane. &#39;seg_p2&#39; is the second</span>
<span class="sd">        point of the wall segment, and &#39;vertex&#39; is a given vertex of the</span>
<span class="sd">        window that you want to translate from 3D coordinates into 2D. All</span>
<span class="sd">        input points are presented as arrays of 3 floats and the output is</span>
<span class="sd">        an array of 2 (x, y) coordinates.</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">        def dot_product(v1, v2):</span>
<span class="sd">            return v1[0] * v2[0] + v1[1] * v2[1] + v1[2] * v2[3]</span>

<span class="sd">        def normalize(v):</span>
<span class="sd">            d = (v[0] ** 2 + v[1] ** 2 + v[2] ** 2) ** 0.5</span>
<span class="sd">            return (v[0] / d, v[1] / d, v[2] / d)</span>

<span class="sd">        def xyz_to_xy(seg_p1, seg_p2, vertex):</span>
<span class="sd">            diff = (vertex[0] - seg_p1[0], vertex[1] - seg_p1[1], vertex[2] - seg_p1[2])</span>
<span class="sd">            axis = (seg_p2[0] - seg_p1[0], seg_p2[1] - seg_p1[1], seg_p2[2] - seg_p1[2])</span>
<span class="sd">            plane_x = normalize(axis)</span>
<span class="sd">            plane_y = (0, 0, 1)</span>
<span class="sd">            return (dot_product(plane_x , diff), dot_product(plane_y, diff))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_polygons&#39;</span><span class="p">,</span> <span class="s1">&#39;_are_doors&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">polygons</span><span class="p">,</span> <span class="n">are_doors</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize DetailedWindows.&quot;&quot;&quot;</span>
        <span class="n">_WindowParameterBase</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="c1"># add the user_data</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">polygons</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">polygons</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">polygons</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">polygon</span> <span class="ow">in</span> <span class="n">polygons</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">polygon</span><span class="p">,</span> <span class="n">Polygon2D</span><span class="p">),</span> \
                <span class="s1">&#39;Expected Polygon2D for window polygon. Got </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">polygon</span><span class="p">))</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">polygons</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span> \
            <span class="s1">&#39;There must be at least one polygon to use DetailedWindows.&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_polygons</span> <span class="o">=</span> <span class="n">polygons</span>
        <span class="k">if</span> <span class="n">are_doors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_are_doors</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">polygons</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">are_doors</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">are_doors</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">are_doors</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">is_dr</span> <span class="ow">in</span> <span class="n">are_doors</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">is_dr</span><span class="p">,</span> <span class="nb">bool</span><span class="p">),</span> <span class="s1">&#39;Expected booleans for &#39;</span> \
                    <span class="s1">&#39;DetailedWindow.are_doors. Got </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">is_dr</span><span class="p">))</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">are_doors</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">polygons</span><span class="p">),</span> \
                <span class="s1">&#39;Length of DetailedWindow.are_doors (</span><span class="si">{}</span><span class="s1">) does not match the length &#39;</span> \
                <span class="s1">&#39;of DetailedWindow.polygons (</span><span class="si">{}</span><span class="s1">).&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">are_doors</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">polygons</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_are_doors</span> <span class="o">=</span> <span class="n">are_doors</span>

<div class="viewcode-block" id="DetailedWindows.from_face3ds"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.DetailedWindows.from_face3ds">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_face3ds</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">face3ds</span><span class="p">,</span> <span class="n">segment</span><span class="p">,</span> <span class="n">are_doors</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create DetailedWindows from Face3Ds and a segment they are assigned to.</span>

<span class="sd">        Args:</span>
<span class="sd">            face3ds: A list of Face3D objects for the detailed windows.</span>
<span class="sd">            segment: A LineSegment3D that sets the plane in which 3D vertices</span>
<span class="sd">                are located.</span>
<span class="sd">            are_doors: An array of booleans that align with the face3ds and note whether</span>
<span class="sd">                each of the polygons represents a door (True) or a window (False).</span>
<span class="sd">                If None, it will be assumed that all polygons represent windows and</span>
<span class="sd">                they will be translated to Apertures in any resulting Honeybee</span>
<span class="sd">                model. (Default: None).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">plane</span> <span class="o">=</span> <span class="n">Plane</span><span class="p">(</span><span class="n">Vector3D</span><span class="p">(</span><span class="n">segment</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="n">segment</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">segment</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="n">segment</span><span class="o">.</span><span class="n">v</span><span class="p">)</span>
        <span class="n">pt3d</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">pt</span> <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">face</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span> <span class="k">for</span> <span class="n">face</span> <span class="ow">in</span> <span class="n">face3ds</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="nb">tuple</span><span class="p">(</span><span class="n">Polygon2D</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">plane</span><span class="o">.</span><span class="n">xyz_to_xy</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">poly</span><span class="p">))</span>
                  <span class="k">for</span> <span class="n">poly</span> <span class="ow">in</span> <span class="n">pt3d</span><span class="p">),</span>
            <span class="n">are_doors</span>
        <span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">polygons</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get an array of Polygon2Ds with one polygon for each window.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_polygons</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">are_doors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get an array of booleans that note whether each polygon is a door.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_are_doors</span>

<div class="viewcode-block" id="DetailedWindows.is_flipped_equivalent"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.DetailedWindows.is_flipped_equivalent">[docs]</a>    <span class="k">def</span> <span class="nf">is_flipped_equivalent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">segment</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if this WindowParameter is equal to another when flipped.</span>

<span class="sd">        This is useful to know if the window parameters will be valid when translated</span>
<span class="sd">        to Honeybee when they are adjacent to the other.</span>

<span class="sd">        Args:</span>
<span class="sd">            other: Another WindowParameter object for which flipped equivalency</span>
<span class="sd">                will be tested.</span>
<span class="sd">            segment: A LineSegment3D to which these parameters are applied.</span>
<span class="sd">            tolerance: The minimum distance between a vertex and the edge of the</span>
<span class="sd">                wall segment that is considered not touching. (Default: 0.01, suitable</span>
<span class="sd">                for objects in meters).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># first check some fundamental things</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">DetailedWindows</span><span class="p">)</span> <span class="ow">or</span> \
                <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_polygons</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">_polygons</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="c1"># then, check that the polygons actually match</span>
        <span class="n">other_flip</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">segment</span><span class="o">.</span><span class="n">length</span><span class="p">)</span>
        <span class="n">found_adjacencies</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">poly_1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_polygons</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">poly_2</span> <span class="ow">in</span> <span class="n">other_flip</span><span class="o">.</span><span class="n">_polygons</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">poly_1</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="n">distance_to_point</span><span class="p">(</span><span class="n">poly_2</span><span class="o">.</span><span class="n">center</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">tolerance</span><span class="p">:</span>
                    <span class="n">found_adjacencies</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">break</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_polygons</span><span class="p">)</span> <span class="o">==</span> <span class="n">found_adjacencies</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="DetailedWindows.area_from_segment"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.DetailedWindows.area_from_segment">[docs]</a>    <span class="k">def</span> <span class="nf">area_from_segment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">segment</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the window area generated by these parameters from a LineSegment3D.</span>

<span class="sd">        Args:</span>
<span class="sd">            segment: A LineSegment3D to which these parameters are applied.</span>
<span class="sd">            floor_to_ceiling_height: The floor-to-ceiling height of the Room2D</span>
<span class="sd">                to which the segment belongs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">polygon</span><span class="o">.</span><span class="n">area</span> <span class="k">for</span> <span class="n">polygon</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_polygons</span><span class="p">)</span></div>

<div class="viewcode-block" id="DetailedWindows.check_valid_for_segment"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.DetailedWindows.check_valid_for_segment">[docs]</a>    <span class="k">def</span> <span class="nf">check_valid_for_segment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">segment</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check that these window parameters are valid for a given LineSegment3D.</span>

<span class="sd">        Args:</span>
<span class="sd">            segment: A LineSegment3D to which these parameters are applied.</span>
<span class="sd">            floor_to_ceiling_height: The floor-to-ceiling height of the Room2D</span>
<span class="sd">                to which the segment belongs.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A string with the message. Will be an empty string if valid.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># first check that the total window area isn&#39;t larger than the wall</span>
        <span class="n">max_width</span> <span class="o">=</span> <span class="n">segment</span><span class="o">.</span><span class="n">length</span>
        <span class="n">total_area</span> <span class="o">=</span> <span class="n">max_width</span> <span class="o">*</span> <span class="n">floor_to_ceiling_height</span>
        <span class="n">win_area</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">area_from_segment</span><span class="p">(</span><span class="n">segment</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">win_area</span> <span class="o">&gt;=</span> <span class="n">total_area</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;Total area of windows [</span><span class="si">{}</span><span class="s1">] is greater than the area of the &#39;</span> \
                <span class="s1">&#39;parent wall [</span><span class="si">{}</span><span class="s1">].&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">win_area</span><span class="p">,</span> <span class="n">total_area</span><span class="p">)</span>
        <span class="c1"># next, check to be sure that no window is out of the wall boundary</span>
        <span class="n">msg_template</span> <span class="o">=</span> <span class="s1">&#39;Vertex 2D </span><span class="si">{}</span><span class="s1"> coordinate [</span><span class="si">{}</span><span class="s1">] is outside the range allowed &#39;</span> \
            <span class="s1">&#39;by the parent wall segment.&#39;</span>
        <span class="k">for</span> <span class="n">p_gon</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">polygons</span><span class="p">:</span>
            <span class="n">min_pt</span><span class="p">,</span> <span class="n">max_pt</span> <span class="o">=</span> <span class="n">p_gon</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="n">p_gon</span><span class="o">.</span><span class="n">max</span>
            <span class="k">if</span> <span class="n">min_pt</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">msg_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">min_pt</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">min_pt</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">msg_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">min_pt</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">max_pt</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">max_width</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">msg_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">max_pt</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">max_pt</span><span class="o">.</span><span class="n">y</span> <span class="o">&gt;=</span> <span class="n">floor_to_ceiling_height</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">msg_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">max_pt</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span></div>

<div class="viewcode-block" id="DetailedWindows.adjust_for_segment"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.DetailedWindows.adjust_for_segment">[docs]</a>    <span class="k">def</span> <span class="nf">adjust_for_segment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">segment</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get these parameters with vertices excluded beyond the domain of a given line.</span>

<span class="sd">        Args:</span>
<span class="sd">            segment: A LineSegment3D to which these parameters are applied.</span>
<span class="sd">            floor_to_ceiling_height: The floor-to-ceiling height of the Room2D</span>
<span class="sd">                to which the segment belongs.</span>
<span class="sd">            tolerance: The minimum distance between a vertex and the edge of the</span>
<span class="sd">                wall segment that is considered not touching. (Default: 0.01, suitable</span>
<span class="sd">                for objects in meters).</span>

<span class="sd">        Returns:</span>
<span class="sd">            A new DetailedWindows object that fits entirely in the domain of the</span>
<span class="sd">            input line segment and floor_to_ceiling_height.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># compute the maximum width and height</span>
        <span class="n">max_width</span> <span class="o">=</span> <span class="n">segment</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span> <span class="n">tolerance</span>
        <span class="n">max_height</span> <span class="o">=</span> <span class="n">floor_to_ceiling_height</span> <span class="o">-</span> <span class="n">tolerance</span>

        <span class="c1"># loop through the vertices and adjust them</span>
        <span class="n">new_polygons</span><span class="p">,</span> <span class="n">new_are_doors</span><span class="p">,</span> <span class="n">kept_i</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">p_gon</span><span class="p">,</span> <span class="n">is_dr</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polygons</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">are_doors</span><span class="p">)):</span>
            <span class="n">new_verts</span><span class="p">,</span> <span class="n">verts_moved</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">vert</span> <span class="ow">in</span> <span class="n">p_gon</span><span class="p">:</span>
                <span class="n">x_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">v_moved</span> <span class="o">=</span> <span class="n">vert</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">vert</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">x_val</span> <span class="o">&lt;=</span> <span class="n">tolerance</span><span class="p">:</span>
                    <span class="n">x_val</span><span class="p">,</span> <span class="n">v_moved</span> <span class="o">=</span> <span class="n">tolerance</span><span class="p">,</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="n">y_val</span> <span class="o">&lt;=</span> <span class="n">tolerance</span><span class="p">:</span>
                    <span class="n">y_val</span><span class="p">,</span> <span class="n">v_moved</span> <span class="o">=</span> <span class="n">tolerance</span><span class="p">,</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="n">x_val</span> <span class="o">&gt;=</span> <span class="n">max_width</span><span class="p">:</span>
                    <span class="n">x_val</span><span class="p">,</span> <span class="n">v_moved</span> <span class="o">=</span> <span class="n">max_width</span><span class="p">,</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="n">y_val</span> <span class="o">&gt;=</span> <span class="n">max_height</span><span class="p">:</span>
                    <span class="n">y_val</span><span class="p">,</span> <span class="n">v_moved</span> <span class="o">=</span> <span class="n">max_height</span><span class="p">,</span> <span class="kc">True</span>
                <span class="n">new_verts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Point2D</span><span class="p">(</span><span class="n">x_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">))</span>
                <span class="n">verts_moved</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v_moved</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">verts_moved</span><span class="p">):</span>
                <span class="n">new_polygons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Polygon2D</span><span class="p">(</span><span class="n">new_verts</span><span class="p">))</span>
                <span class="n">new_are_doors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">is_dr</span><span class="p">)</span>
                <span class="n">kept_i</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

        <span class="c1"># return the final window parameters</span>
        <span class="n">new_w_par</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_polygons</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">new_w_par</span> <span class="o">=</span> <span class="n">DetailedWindows</span><span class="p">(</span><span class="n">new_polygons</span><span class="p">,</span> <span class="n">new_are_doors</span><span class="p">)</span>

        <span class="c1"># update user_data lists if some windows were not added</span>
        <span class="k">if</span> <span class="n">new_w_par</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">clean_u</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_polygons</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polygons</span><span class="p">):</span>
                <span class="n">clean_u</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polygons</span><span class="p">):</span>
                        <span class="n">clean_u</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">kept_i</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">clean_u</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
            <span class="n">new_w_par</span><span class="o">.</span><span class="n">user_data</span> <span class="o">=</span> <span class="n">clean_u</span>
        <span class="k">return</span> <span class="n">new_w_par</span></div>

<div class="viewcode-block" id="DetailedWindows.to_rectangular_windows"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.DetailedWindows.to_rectangular_windows">[docs]</a>    <span class="k">def</span> <span class="nf">to_rectangular_windows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">segment</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a version of these WindowParameters as RectangularWindows.</span>

<span class="sd">        Args:</span>
<span class="sd">            segment: A LineSegment3D to which these parameters are applied.</span>
<span class="sd">            floor_to_ceiling_height: The floor-to-ceiling height of the Room2D</span>
<span class="sd">                to which the segment belongs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">origins</span><span class="p">,</span> <span class="n">widths</span><span class="p">,</span> <span class="n">heights</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">poly</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">polygons</span><span class="p">:</span>
            <span class="n">min_pt</span><span class="p">,</span> <span class="n">max_pt</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">max</span>
            <span class="n">origins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">min_pt</span><span class="p">)</span>
            <span class="n">widths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">max_pt</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">min_pt</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
            <span class="n">heights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">max_pt</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">min_pt</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="n">new_w</span> <span class="o">=</span> <span class="n">RectangularWindows</span><span class="p">(</span><span class="n">origins</span><span class="p">,</span> <span class="n">widths</span><span class="p">,</span> <span class="n">heights</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">are_doors</span><span class="p">)</span>
        <span class="n">new_w</span><span class="o">.</span><span class="n">_user_data</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">new_w</span></div>

<div class="viewcode-block" id="DetailedWindows.add_window_to_face"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.DetailedWindows.add_window_to_face">[docs]</a>    <span class="k">def</span> <span class="nf">add_window_to_face</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">face</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add Apertures to a Honeybee Face using these Window Parameters.</span>

<span class="sd">        Args:</span>
<span class="sd">            face: A honeybee-core Face object.</span>
<span class="sd">            tolerance: Optional tolerance value. Default: 0.01, suitable for</span>
<span class="sd">                objects in meters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get the plane of the parent wall</span>
        <span class="n">wall_plane</span> <span class="o">=</span> <span class="n">face</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">plane</span>
        <span class="n">wall_plane</span> <span class="o">=</span> <span class="n">wall_plane</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">wall_plane</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">wall_plane</span><span class="o">.</span><span class="n">o</span><span class="p">)</span>
        <span class="n">width_seg</span> <span class="o">=</span> <span class="n">LineSegment3D</span><span class="o">.</span><span class="n">from_end_points</span><span class="p">(</span><span class="n">face</span><span class="o">.</span><span class="n">geometry</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">face</span><span class="o">.</span><span class="n">geometry</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">h_vec</span><span class="p">,</span> <span class="n">b_pt</span> <span class="o">=</span> <span class="n">Vector3D</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">face</span><span class="o">.</span><span class="n">max</span><span class="o">.</span><span class="n">z</span> <span class="o">-</span> <span class="n">face</span><span class="o">.</span><span class="n">min</span><span class="o">.</span><span class="n">z</span><span class="p">),</span> <span class="n">face</span><span class="o">.</span><span class="n">geometry</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">height_seg</span> <span class="o">=</span> <span class="n">LineSegment3D</span><span class="o">.</span><span class="n">from_end_points</span><span class="p">(</span><span class="n">b_pt</span><span class="p">,</span> <span class="n">b_pt</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">h_vec</span><span class="p">))</span>
        <span class="n">max_width</span> <span class="o">=</span> <span class="n">width_seg</span><span class="o">.</span><span class="n">length</span> <span class="o">*</span> <span class="mf">0.99</span>
        <span class="n">max_height</span> <span class="o">=</span> <span class="n">height_seg</span><span class="o">.</span><span class="n">length</span> <span class="o">*</span> <span class="mf">0.99</span>

        <span class="c1"># automatically clip any geometries outside of the face so they are bounded by it</span>
        <span class="n">clean_polygons</span><span class="p">,</span> <span class="n">clean_are_doors</span><span class="p">,</span> <span class="n">kept_i</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">p_gon</span><span class="p">,</span> <span class="n">is_dr</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polygons</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">are_doors</span><span class="p">)):</span>
            <span class="n">new_verts</span><span class="p">,</span> <span class="n">verts_moved</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">vert</span> <span class="ow">in</span> <span class="n">p_gon</span><span class="p">:</span>
                <span class="n">x_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">v_moved</span> <span class="o">=</span> <span class="n">vert</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">vert</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">x_val</span> <span class="o">&lt;=</span> <span class="n">tolerance</span><span class="p">:</span>
                    <span class="n">x_val</span><span class="p">,</span> <span class="n">v_moved</span> <span class="o">=</span> <span class="n">tolerance</span><span class="p">,</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="n">y_val</span> <span class="o">&lt;=</span> <span class="n">tolerance</span><span class="p">:</span>
                    <span class="n">y_val</span><span class="p">,</span> <span class="n">v_moved</span> <span class="o">=</span> <span class="n">tolerance</span><span class="p">,</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="n">x_val</span> <span class="o">&gt;=</span> <span class="n">max_width</span><span class="p">:</span>
                    <span class="n">x_val</span><span class="p">,</span> <span class="n">v_moved</span> <span class="o">=</span> <span class="n">max_width</span><span class="p">,</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="n">y_val</span> <span class="o">&gt;=</span> <span class="n">max_height</span><span class="p">:</span>
                    <span class="n">y_val</span><span class="p">,</span> <span class="n">v_moved</span> <span class="o">=</span> <span class="n">max_height</span><span class="p">,</span> <span class="kc">True</span>
                <span class="n">new_verts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Point2D</span><span class="p">(</span><span class="n">x_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">))</span>
                <span class="n">verts_moved</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v_moved</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">verts_moved</span><span class="p">):</span>
                <span class="n">clean_polygons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_verts</span><span class="p">)</span>
                <span class="n">clean_are_doors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">is_dr</span><span class="p">)</span>
                <span class="n">kept_i</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

        <span class="c1"># update user_data lists if some windows were not added</span>
        <span class="n">clean_u</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">clean_polygons</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polygons</span><span class="p">):</span>
                <span class="n">clean_u</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polygons</span><span class="p">):</span>
                        <span class="n">clean_u</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">kept_i</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">clean_u</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>

        <span class="c1"># loop through each window and create its geometry</span>
        <span class="n">sub_faces</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">polygon</span><span class="p">,</span> <span class="n">isd</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">clean_polygons</span><span class="p">,</span> <span class="n">clean_are_doors</span><span class="p">)):</span>
            <span class="n">pt3d</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">wall_plane</span><span class="o">.</span><span class="n">xy_to_xyz</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">polygon</span><span class="p">)</span>
            <span class="n">s_geo</span> <span class="o">=</span> <span class="n">Face3D</span><span class="p">(</span><span class="n">pt3d</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">isd</span><span class="p">:</span>
                <span class="n">sub_f</span> <span class="o">=</span> <span class="n">Door</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_Door</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">face</span><span class="o">.</span><span class="n">identifier</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">s_geo</span><span class="p">)</span>
                <span class="n">face</span><span class="o">.</span><span class="n">add_door</span><span class="p">(</span><span class="n">sub_f</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sub_f</span> <span class="o">=</span> <span class="n">Aperture</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_Glz</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">face</span><span class="o">.</span><span class="n">identifier</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">s_geo</span><span class="p">)</span>
                <span class="n">face</span><span class="o">.</span><span class="n">add_aperture</span><span class="p">(</span><span class="n">sub_f</span><span class="p">)</span>
            <span class="n">sub_faces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sub_f</span><span class="p">)</span>
            <span class="c1"># if the Aperture is interior, set adjacent boundary condition</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">face</span><span class="o">.</span><span class="n">_boundary_condition</span><span class="p">,</span> <span class="n">Surface</span><span class="p">):</span>
                <span class="n">ids</span> <span class="o">=</span> <span class="n">face</span><span class="o">.</span><span class="n">_boundary_condition</span><span class="o">.</span><span class="n">boundary_condition_objects</span>
                <span class="n">sf_type</span> <span class="o">=</span> <span class="s1">&#39;Door&#39;</span> <span class="k">if</span> <span class="n">isd</span> <span class="k">else</span> <span class="s1">&#39;Glz&#39;</span>
                <span class="n">adj_sf_id</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sf_type</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">final_ids</span> <span class="o">=</span> <span class="p">(</span><span class="n">adj_sf_id</span><span class="p">,)</span> <span class="o">+</span> <span class="n">ids</span>
                <span class="n">sub_f</span><span class="o">.</span><span class="n">boundary_condition</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">final_ids</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_apply_user_data_to_honeybee</span><span class="p">(</span><span class="n">sub_faces</span><span class="p">,</span> <span class="n">clean_u</span><span class="p">)</span></div>

<div class="viewcode-block" id="DetailedWindows.scale"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.DetailedWindows.scale">[docs]</a>    <span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a scaled version of these WindowParameters.</span>

<span class="sd">        This method is called within the scale methods of the Room2D.</span>

<span class="sd">        Args:</span>
<span class="sd">            factor: A number representing how much the object should be scaled.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_w</span> <span class="o">=</span> <span class="n">DetailedWindows</span><span class="p">(</span>
            <span class="nb">tuple</span><span class="p">(</span><span class="n">polygon</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">factor</span><span class="p">)</span> <span class="k">for</span> <span class="n">polygon</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">polygons</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">are_doors</span><span class="p">)</span>
        <span class="n">new_w</span><span class="o">.</span><span class="n">_user_data</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">new_w</span></div>

<div class="viewcode-block" id="DetailedWindows.flip"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.DetailedWindows.flip">[docs]</a>    <span class="k">def</span> <span class="nf">flip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seg_length</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Flip the direction of the windows along a segment.</span>

<span class="sd">        This is needed since windows can exist asymmetrically across the wall</span>
<span class="sd">        segment and operations like reflecting the Room2D across a plane will</span>
<span class="sd">        require the window parameters to be flipped to remain in the same place.</span>

<span class="sd">        Args:</span>
<span class="sd">            seg_length: The length of the segment along which the parameters are</span>
<span class="sd">                being flipped.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># set values derived from the property of the segment</span>
        <span class="n">normal</span> <span class="o">=</span> <span class="n">Vector2D</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">origin</span> <span class="o">=</span> <span class="n">Point2D</span><span class="p">(</span><span class="n">seg_length</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="c1"># loop through the polygons and reflect them across the mid plane of the wall</span>
        <span class="n">new_polygons</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">polygon</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">polygons</span><span class="p">:</span>
            <span class="n">new_verts</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">reflect</span><span class="p">(</span><span class="n">normal</span><span class="p">,</span> <span class="n">origin</span><span class="p">)</span> <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">polygon</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
            <span class="n">new_polygons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Polygon2D</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">new_verts</span><span class="p">))))</span>
        <span class="n">new_w</span> <span class="o">=</span> <span class="n">DetailedWindows</span><span class="p">(</span><span class="n">new_polygons</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">are_doors</span><span class="p">)</span>
        <span class="n">new_w</span><span class="o">.</span><span class="n">_user_data</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">new_w</span></div>

<div class="viewcode-block" id="DetailedWindows.split"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.DetailedWindows.split">[docs]</a>    <span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">segments</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Split DetailedWindows parameters across a list of ordered segments.</span>

<span class="sd">        Args:</span>
<span class="sd">            segments: The segments to which the window parameters are being</span>
<span class="sd">                split across. These should be in order as they appear on the</span>
<span class="sd">                parent Room2D.</span>
<span class="sd">            tolerance: The minimum distance between a vertex and the edge of the</span>
<span class="sd">                wall segment that is considered not touching. (Default: 0.01, suitable</span>
<span class="sd">                for objects in meters).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_win_pars</span><span class="p">,</span> <span class="n">win_par_is</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="n">rel_polygons</span><span class="p">,</span> <span class="n">rel_dr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">polygons</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">are_doors</span>
        <span class="n">rel_i</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polygons</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="n">segments</span><span class="p">:</span>
            <span class="c1"># loop through the vertices and adjust them to the max width</span>
            <span class="n">max_width</span> <span class="o">=</span> <span class="n">segment</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span> <span class="n">tolerance</span>
            <span class="n">win_par_i</span><span class="p">,</span> <span class="n">out_i</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
            <span class="n">new_polygons</span><span class="p">,</span> <span class="n">new_dr</span><span class="p">,</span> <span class="n">out_polygons</span><span class="p">,</span> <span class="n">out_dr</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">p_gon</span><span class="p">,</span> <span class="n">is_dr</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">rel_polygons</span><span class="p">,</span> <span class="n">rel_dr</span><span class="p">,</span> <span class="n">rel_i</span><span class="p">):</span>
                <span class="n">new_verts</span><span class="p">,</span> <span class="n">verts_moved</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">vert</span> <span class="ow">in</span> <span class="n">p_gon</span><span class="p">:</span>
                    <span class="n">x_val</span><span class="p">,</span> <span class="n">v_moved</span> <span class="o">=</span> <span class="n">vert</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="kc">False</span>
                    <span class="k">if</span> <span class="n">x_val</span> <span class="o">&lt;=</span> <span class="n">tolerance</span><span class="p">:</span>
                        <span class="n">x_val</span><span class="p">,</span> <span class="n">v_moved</span> <span class="o">=</span> <span class="n">tolerance</span><span class="p">,</span> <span class="kc">True</span>
                    <span class="k">if</span> <span class="n">x_val</span> <span class="o">&gt;=</span> <span class="n">max_width</span><span class="p">:</span>
                        <span class="n">x_val</span><span class="p">,</span> <span class="n">v_moved</span> <span class="o">=</span> <span class="n">max_width</span><span class="p">,</span> <span class="kc">True</span>
                    <span class="n">new_verts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Point2D</span><span class="p">(</span><span class="n">x_val</span><span class="p">,</span> <span class="n">vert</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
                    <span class="n">verts_moved</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v_moved</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">verts_moved</span><span class="p">):</span>
                    <span class="n">new_polygons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Polygon2D</span><span class="p">(</span><span class="n">new_verts</span><span class="p">))</span>
                    <span class="n">win_par_i</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                    <span class="n">new_dr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">is_dr</span><span class="p">)</span>
                    <span class="k">if</span> <span class="kc">True</span> <span class="ow">in</span> <span class="n">verts_moved</span><span class="p">:</span>  <span class="c1"># outside of the segment</span>
                        <span class="n">out_polygons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_gon</span><span class="p">)</span>
                        <span class="n">out_dr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">is_dr</span><span class="p">)</span>
                        <span class="n">out_i</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">out_polygons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_gon</span><span class="p">)</span>
                    <span class="n">out_dr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">is_dr</span><span class="p">)</span>
                    <span class="n">out_i</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="c1"># build the final window parameters from the adjusted polygons</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_polygons</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">new_win_pars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DetailedWindows</span><span class="p">(</span><span class="n">new_polygons</span><span class="p">,</span> <span class="n">new_dr</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_win_pars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="n">win_par_is</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">win_par_i</span><span class="p">)</span>
            <span class="c1"># shift all polygons to be relevant for the next segment</span>
            <span class="n">shift_dist</span> <span class="o">=</span> <span class="n">segment</span><span class="o">.</span><span class="n">length</span>
            <span class="n">rel_polygons</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">p_gon</span> <span class="ow">in</span> <span class="n">out_polygons</span><span class="p">:</span>
                <span class="n">new_v</span> <span class="o">=</span> <span class="p">[</span><span class="n">Point2D</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">shift_dist</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">p_gon</span><span class="p">]</span>
                <span class="n">rel_polygons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Polygon2D</span><span class="p">(</span><span class="n">new_v</span><span class="p">))</span>
            <span class="n">rel_dr</span> <span class="o">=</span> <span class="n">out_dr</span>
            <span class="n">rel_i</span> <span class="o">=</span> <span class="n">out_i</span>

        <span class="c1"># apply the user_data to the split window parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_split_user_data</span><span class="p">(</span><span class="n">new_win_pars</span><span class="p">,</span> <span class="n">win_par_is</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_win_pars</span></div>

<div class="viewcode-block" id="DetailedWindows.merge"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.DetailedWindows.merge">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="n">window_parameters</span><span class="p">,</span> <span class="n">segments</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Merge DetailedWindows parameters together using their assigned segments.</span>

<span class="sd">        Args:</span>
<span class="sd">            window_parameters: A list of WindowParameters to be merged.</span>
<span class="sd">            segments: The segments to which the window parameters are assigned.</span>
<span class="sd">                These should be in order as they appear on the parent Room2D.</span>
<span class="sd">            floor_to_ceiling_height: The floor-to-ceiling height of the Room2D</span>
<span class="sd">                to which the segment belongs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">base_x</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">polygons</span><span class="p">,</span> <span class="n">are_doors</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">wp</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">window_parameters</span><span class="p">,</span> <span class="n">segments</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">wp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wp</span><span class="p">,</span> <span class="n">DetailedWindows</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">p_gon</span><span class="p">,</span> <span class="n">is_dr</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">wp</span><span class="o">.</span><span class="n">polygons</span><span class="p">,</span> <span class="n">wp</span><span class="o">.</span><span class="n">are_doors</span><span class="p">):</span>
                        <span class="n">new_pts</span> <span class="o">=</span> <span class="p">[</span><span class="n">Point2D</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">base_x</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">p_gon</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
                        <span class="n">polygons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Polygon2D</span><span class="p">(</span><span class="n">new_pts</span><span class="p">))</span>
                        <span class="n">are_doors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">is_dr</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># not all windows are of the same type; convert all to rectangular</span>
                    <span class="k">return</span> <span class="n">_WindowParameterBase</span><span class="o">.</span><span class="n">merge_to_rectangular</span><span class="p">(</span>
                        <span class="n">window_parameters</span><span class="p">,</span> <span class="n">segments</span><span class="p">,</span> <span class="n">floor_to_ceiling_height</span><span class="p">)</span>
            <span class="n">base_x</span> <span class="o">+=</span> <span class="n">s</span><span class="o">.</span><span class="n">length</span>
        <span class="n">new_w_par</span> <span class="o">=</span> <span class="n">DetailedWindows</span><span class="p">(</span><span class="n">polygons</span><span class="p">,</span> <span class="n">are_doors</span><span class="p">)</span>
        <span class="n">new_w_par</span><span class="o">.</span><span class="n">_merge_user_data</span><span class="p">(</span><span class="n">window_parameters</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_w_par</span></div>

<div class="viewcode-block" id="DetailedWindows.from_dict"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.DetailedWindows.from_dict">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">segment</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create DetailedWindows from a dictionary.</span>

<span class="sd">        Args:</span>
<span class="sd">            data: A dictionary in the format below. The vertices of the &quot;polygons&quot;</span>
<span class="sd">                can either contain 2 values (indicating they are vertices within</span>
<span class="sd">                the plane of a parent wall segment) or they can contain 3 values</span>
<span class="sd">                (indicating they are 3D world coordinates). If 3 values are used,</span>
<span class="sd">                a segment must be specified below to convert them to the 2D format.</span>
<span class="sd">            segment: A LineSegment3D that sets the plane in which 3D vertices</span>
<span class="sd">                are located.</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            {</span>
<span class="sd">            &quot;type&quot;: &quot;DetailedWindows&quot;,</span>
<span class="sd">            &quot;polygons&quot;: [((0.5, 0.5), (2, 0.5), (2, 2), (0.5, 2)),</span>
<span class="sd">                         ((3, 1), (4, 1), (4, 2))],</span>
<span class="sd">            &quot;are_doors&quot;: [False]</span>
<span class="sd">            }</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;DetailedWindows&#39;</span><span class="p">,</span> \
            <span class="s1">&#39;Expected DetailedWindows dictionary. Got </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">])</span>
        <span class="n">are_doors</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;are_doors&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;are_doors&#39;</span> <span class="ow">in</span> <span class="n">data</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;polygons&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">new_w_par</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span>
                <span class="nb">tuple</span><span class="p">(</span><span class="n">Polygon2D</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">Point2D</span><span class="o">.</span><span class="n">from_array</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">poly</span><span class="p">))</span>
                      <span class="k">for</span> <span class="n">poly</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;polygons&#39;</span><span class="p">]),</span>
                <span class="n">are_doors</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">segment</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;Segment must be specified when using 3D &#39;</span> \
                <span class="s1">&#39;vertices for DetailedWindows.&#39;</span>
            <span class="n">plane</span> <span class="o">=</span> <span class="n">Plane</span><span class="p">(</span><span class="n">Vector3D</span><span class="p">(</span><span class="n">segment</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="n">segment</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">segment</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="n">segment</span><span class="o">.</span><span class="n">v</span><span class="p">)</span>
            <span class="n">pt3d</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">Point3D</span><span class="o">.</span><span class="n">from_array</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">poly</span><span class="p">)</span>
                         <span class="k">for</span> <span class="n">poly</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;polygons&#39;</span><span class="p">])</span>
            <span class="n">new_w_par</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span>
                <span class="nb">tuple</span><span class="p">(</span><span class="n">Polygon2D</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">plane</span><span class="o">.</span><span class="n">xyz_to_xy</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">poly</span><span class="p">))</span>
                      <span class="k">for</span> <span class="n">poly</span> <span class="ow">in</span> <span class="n">pt3d</span><span class="p">),</span>
                <span class="n">are_doors</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;user_data&#39;</span> <span class="ow">in</span> <span class="n">data</span> <span class="ow">and</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;user_data&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">new_w_par</span><span class="o">.</span><span class="n">user_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;user_data&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">new_w_par</span></div>

<div class="viewcode-block" id="DetailedWindows.to_dict"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.DetailedWindows.to_dict">[docs]</a>    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get DetailedWindows as a dictionary.&quot;&quot;&quot;</span>
        <span class="n">base</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;DetailedWindows&#39;</span><span class="p">,</span>
            <span class="s1">&#39;polygons&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="n">pt</span><span class="o">.</span><span class="n">to_array</span><span class="p">()</span> <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">poly</span><span class="p">]</span> <span class="k">for</span> <span class="n">poly</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">polygons</span><span class="p">],</span>
            <span class="s1">&#39;are_doors&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">are_doors</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">base</span><span class="p">[</span><span class="s1">&#39;user_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span>
        <span class="k">return</span> <span class="n">base</span></div>

<div class="viewcode-block" id="DetailedWindows.is_face3d_in_segment_plane"><a class="viewcode-back" href="../../dragonfly.windowparameter.html#dragonfly.windowparameter.DetailedWindows.is_face3d_in_segment_plane">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">is_face3d_in_segment_plane</span><span class="p">(</span>
            <span class="n">face3d</span><span class="p">,</span> <span class="n">segment</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">angle_tolerance</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if a given Face3D is in the plane and range of a LineSegment3D.</span>

<span class="sd">        Args:</span>
<span class="sd">            face3d: A list of Face3D objects for the detailed windows.</span>
<span class="sd">            segment: A LineSegment3D that sets the plane in which 3D vertices</span>
<span class="sd">                are located.</span>
<span class="sd">            height: A number for the height of the wall formed by extruding the segment.</span>
<span class="sd">            tolerance: The minimum difference between the coordinate values of two</span>
<span class="sd">                vertices at which they can be considered equivalent. Default: 0.01,</span>
<span class="sd">                suitable for objects in meters.</span>
<span class="sd">            angle_tolerance: The max angle in degrees that the plane normals can</span>
<span class="sd">                differ from one another in order for them to be considered coplanar.</span>
<span class="sd">                Default: 1 degree.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if the face3d is in the plane and range of the segment. False</span>
<span class="sd">            if it is not.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">plane</span> <span class="o">=</span> <span class="n">Plane</span><span class="p">(</span><span class="n">Vector3D</span><span class="p">(</span><span class="n">segment</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="n">segment</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">segment</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="n">segment</span><span class="o">.</span><span class="n">v</span><span class="p">)</span>
        <span class="c1"># test whether the face3d is coplanar</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">plane</span><span class="o">.</span><span class="n">is_coplanar_tolerance</span><span class="p">(</span><span class="n">face3d</span><span class="o">.</span><span class="n">plane</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">,</span> <span class="n">angle_tolerance</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">seg_face</span> <span class="o">=</span> <span class="n">Face3D</span><span class="o">.</span><span class="n">from_rectangle</span><span class="p">(</span><span class="n">segment</span><span class="o">.</span><span class="n">length</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">plane</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">seg_face</span><span class="o">.</span><span class="n">is_sub_face</span><span class="p">(</span><span class="n">face3d</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">,</span> <span class="n">angle_tolerance</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">new_w</span> <span class="o">=</span> <span class="n">DetailedWindows</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_polygons</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_are_doors</span><span class="p">)</span>
        <span class="n">new_w</span><span class="o">.</span><span class="n">_user_data</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">new_w</span>

    <span class="k">def</span> <span class="nf">__key</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A tuple based on the object properties, useful for hashing.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">hash</span><span class="p">(</span><span class="n">polygon</span><span class="p">)</span> <span class="k">for</span> <span class="n">polygon</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_polygons</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">are_doors</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__key</span><span class="p">())</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">DetailedWindows</span><span class="p">)</span> <span class="ow">and</span> \
            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_polygons</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">_polygons</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polygons</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;DetailedWindows: [</span><span class="si">{}</span><span class="s1"> windows]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_polygons</span><span class="p">))</span></div>
</pre></div>

    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2023, Ladybug Tools.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.3.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>